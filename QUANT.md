## Квантование и причинность
* [PREV: Абстрактная алгебра множеств](MATHAN.md)
* [PREV: Математические классы](MATHAN.md)

* [Уравнения теоретической физики](#квантование-и-дискретная-математика)
* [Уравнения в частных производных](#уравнения-в-частных-производных)
* [Вариационное исчисление. Минимизация функционала. Метод наименьших квадаратов.](#уравнения-в-частных-производных)
* [Производные и конечные разности](#)
* [Операторы в дискретной математике](#)

* [NEXT: Кватернионы и группа вращения](QUAT.md)
* [NEXT: Канонические уравнения Гамильтона](QUAT.md)
* [NEXT: Уравнения теоретической физики](QUAT.md)
* [NEXT: Уравнения электродинамики](QUAT.md)
* [NEXT: Уравнения квантовой механики](QUAT.md)
* [NEXT: Линейная алгебра и аффиннфые преобразования](MATHAN.md)
* [NEXT: Разложение аналитических функций. Базисные полиномы. Сплайны. Интерполяция.](BSPLINE.md)
* [Дробно-рациональные функции и конформные отображения](DSP.md)
* [Цифровая обработка изображений](IMAGES.md)


Автор:
* __[Анатолий Георгиевский](https://github.com/AnatolyGeorgievski)__

Это авторский раздел для дискретной математики, которая должна быть введением к квантовую физику.
Что такое квантование. Я попробую так сформулировать: квантование это представление числовых функций заданных в непрерывном пространстве в целых числах. Квантование порождает дискуссию о причинности в дискретном пространстве.
Я бы хотел сформулировать аксиому причинности в определении вероятностного пространства наравне с понятием непрерывность. Выражения применимые к непрерывным функциям должны давать аналогичный результат для дискретных функций с учетом принципа квантизации.

## Непрерывность и причинность

Дискретное пространство можно сделать непрерывным. Для этого мы будем рассматривать дискретное с шагом $\tau=1$ и обеспечивать непрерывность через аппроксимацию функций на интервале $[0,\tau]$. Аппроксимация выполняется аналитическими функциями для которых можно показать, что в пределе последовательность функций с увеличением степени стремится к непрерывной функции.

Мы вводим понятие пространство с нормированной счетно-аддитивной мерой (вероятностного пространства).

Вводим понятие производная в точке (некоторой области дискретного пространства) при дискретном времени.

$$\frac{d}{dt}f(x;t)=\frac{\Delta{f}}{\tau} = \frac{f(t_n)-f(t_n-\tau)}{\tau} + o(f)$$

В определении есть остаток. Определение производной в математике вводится через предел разбиения интервала времени при $\tau\to 0$. В дискретной математике ($\tau$ - константа) возникает остаток. Этот остаток может накапливаться или отбрасываться или как-то компенсироваться. Мы говорим, что энергия сохраняется, заряд сохраняется. Значит интеграл (понятие непрерывности дает интеграл) по времени введенный в дискретном пространстве на интервале $2\tau$ должен быть константой. Закон сохранения должен выполняться на интервале $2\tau$

Кроме дискретности времени мы вводим понятие квантования величины $f$. $f$ может принимать значения с шагом $h$. Для этого введем специальный символ множества $\mathbb{D}$ - область значений - это класс включает целочисленную величину и остаток $\langle \mathbb{N}, [0,1)\rangle$, остаток - вещественное число на единичном интервале. $h$- принимаем за единицу. 

В плане мультифизических задач, в каждой точке пространства присутствует баланс - сумма энергий - остатки складываются и перераспределяются таким образом, чтобы минимизировать суммарную ошибку. Это базовый принцип в физике - принцип наименьшего действия. 

Понятие непрерывность в дискретном пространстве вводим через правила суммирования и компенсации остатка. Вместе целая и дробная часть числа ведут себя точно так же как и непрерывные функции на множестве вещественных чисел $\mathbb{R}$. Квантовые величины - дискретные, но существуют во времени. То что ушло в остаток в один момент времени добавляется при следующем взаимодействии, в следующий момент.

Какова величина остатка? В дискретном пространстве существует некоторая константа при данном выборе $\tau$ и $h$. Назовем эту константу $\hbar$ - это (иеро)глиф состоящий из двух букв. Взаимодействие в точке пространства (на кубике евклидова пространства) может создать остаток в интервале $[0,\hbar)$. Этот остаток сохраняется до следующего акта взаимодействия.

*Непрерывность в квантовой механике определяется, как предельный переход $\hbar \rightarrow 0$. Такой переход в уравнениях квантовой механики приводит к классическим уравнениям в формулировке Гамильтона и уравнениям Гамильтона-Якоби.*

В дискретном пространстве нам нужно определение "обобщенной функции", которое заменяет понятие непрерывной функции и позволяет построить аппроксимацию функции и получить от нее необходимое количество производных на интервале $[0,1)$, чтобы обобщенные функции могли использоваться при решении уравнений. Понятие обобщенной функции можно ввести из соображений вероятности - мы можем определять вероятность детектирования события в точке 0 и точке 1. Естественным математическим объектом для такого определения является _биномиальное распределение_. Из биномиального распределения выводятся такие понятия, как нормальное распределение. Из биномиального распределения выводится аппроксимация ортогональными полиномами в форме Бернштейна. Обобщение полиномов Бернштейна дает B-сплайны. Любая система ортогональных полиномов изоморфна разложению по степеням (разложение в ряд Тейлора существует для любой аналитической функции). Например, разложение может быть выполнено по ортогональным тригонометрическим полиномам - образуя ряд Фурье. 

### Финитные и обобщенные функции

Обобщенная функция в курсе функционального анализа вводится через финитные функции [^1], в тоже время введение данное Дираком дает свое понятие обобщенных функций, к которым относится и дельта-функция Дирака [^2]. В курсе функционального анализа дельта функция относится к обобщенным функциям и имеет свою аппроксимацию в пространстве основных функций, обеспечивающую бесконечное число производных. Бесконечная дифференцируемость нужна для построения аналитических обобщенных функций. Аналитичность на интервале вводится, как возможность представления функции в виде степенного ряда и разложения по ортогональным базисным функциям. Разложение по ортогональным функциям, составляющим базис - полный набор, образует вероятностное пространство (линейное пространство нормированных базисных функций).

> Пусть f - фиксированная функция на числовой прямой интегрируемая в каждом конечном интервале, и пусть $\phi$ - непрерывная функция, обращающаяся в нуль вне конечного интервала $[a,b]$. Такие функции мы будем называть _финитными_. Каждой такой функции $\phi(x)$ можно сопоставить число:
> $$(f,\phi) = \int\limits_{-\infty}^{\infty} f(x) \phi(x)~dx$$
> Фактически, в силу финитности функции $\phi(x)$ интеграл берется по конечному интервалу.

На определении финитной функции вводится линейное пространство базисных (основных) функций , с определением степени разложения (n), так что последовательность функций $\{\phi^{(n)}(x)\}$ сходится к функции $\phi(x)$.

### Гильбертово пространство основных функций

В точке пространства есть две непрерывные величины типа заряд (flow) и типа энергия (effort). Для обозначения пары величин в одном математическом классе мы вводим понятие комплексные числа $\mathbb{C}$ (сопряженные пары функций). Мы можем не различать эти понятия совсем и работать с комплексной переменной, вводя комплексные скалярные величины. Мы можем различать эти понятия и тогда говорить о взаимодействии двух действительных переменных, применяя матрицы перестановки (матрицы Паули) и скалярные величины из множества действительных чисел. 

Центральной теоремой является утверждение, что решения любого дифференциального уравнения от двух переменных (уравнения эллиптического типа) можно представить, как линейную комбинацию - разложение по ортогональным аналитическим функциям. Возможность такого разложения и представление множества решений в гильбертовом пространстве образованном набором собственных функций приводит к математическому аппарату - линейным операторам в гильбертовом пространстве ортогональных функций. Гильбертово пространство образуется на определении скалярного произведения. 

Можно всех запутать лет на 100, введя понятие типа "спин", как угол в комплексной плоскости образованной двумя связанными величинами типа заряд и типа энергия. Следствием закона сохранения энергии и заряда будет закон сохранения спина. 

Тем не менее, спин не является наблюдаемой величиной! У спина нет направления в физическом пространстве и нет геометрического смысла типа вектор. Оно вообще не является физически осмысленной величиной, как и орбита электрона. Мы можем измерять заряд и энергию, но не можем замерить спин и не можем привязать спин к какой-либо наблюдаемой величине. Философию про измеряемые и наблюдаемые величины лучше почерпнуть у Дирака[^2]. Такая величина как спин может рассматриваться, как физическая величина поскольку характеризует физический объект. И позволяет говорить об эффектах взаимодействия, которые приводят к упорядочению и выстраиванию спинов в физической системе. А что такое спин-орбитальное взаимодействие, если наблюдаемой величиной является спектр энергий электронов при рассеянии? Все просто: ни "спин" ни "орбита" не являются наблюдаемой величиной. Оба понятия - математическая абстракция. А вот статистика в спектре - это физика. 

Физикам дозволено врать в интервале $\hbar$. Можно придумать любой эффект рождение и смерть любой ненаблюдаемой частицы. Это можно подтвердить только косвенно. Можно наблюдать невозможное явление на интервале времени меньше $\tau$. Враньем при этом является вывод о существовании непрерывного явления, основанный на статистическом характере самого процесса наблюдения. Наблюдаемыми являются дискретные величины (кванты) со своей статистикой, которая при бесконечном наблюдении дает эффект соответствующего статистического распределения. 

* [^1]: "Колмогоров А.Н., Фомин С.В. Элементы теории функций и функционального анализа Изд. 7. 2023. 572 с. ISBN 978-5-9221-0266-7."
* [^2]: "Дирак П.А.М. Принципы квантовой механики. 2-е издание"


## Квантизатор и деквантизатор

Представим что у нас есть элемент, который снижает разрядность сигнала - квантователь. Квантователь на каждом такте возвращает остаток

$$y = \lfloor x  + Z(x - y) \rfloor$$

В форме передаточной функции можно записать, как композицию из двух функций, для целой и дробной части.
![Квантизатор](images/quant.png "Квантизатор")

Квантователь пропускает целую часть сигнала без изменения и вносит квантовый шум $e[n]$, который накапливается и добавляется к сигналу, пока не происходит испускание кванта.

<!-- Рассмотрим формование шума в контексте квази статического сигнала. Дробная часть сигнала формирует частотно модулированный сигнал на выходе. Усреднение модулированного сигнала позволяет восстановить дробную часть из соотношения среднего числа квантов и периода усреднения. -->

Прохождение кванта через квантователь. Рассмотрим в качестве кванта финитную функцию $\delta(t)$ (гладкая функция обращается в ноль вне интервала) с интегралом равным единице на интервале $[-1,1)$. Начальное значение остатка в квантователе $e[0] =0.5$. Тогда на выходе квантователя будет $y[0]=1$ или $y[1]=1$, а после прохождения входного импульса ошибка будет "нулевая". Интеграл функции на интервале $[-1,1)$ полагаем равным 1, $\mu$ - групповая задержка сигнала (математическое ожидание), $1-\mu$ вероятность прохождения кванта к моменту времени $t=0$.

<!-- Полная вероятность прохождения кванта $(1-\mu){P(x;0)} + \mu \cdot P(x;1) = 1$, где $P(x;t)$ вероятность события в момент $t$. -->

Это утверждение создает парадокс двух котиков, одного котика зажало между двумя тактами времени. *{традиция ставить воображаемые эксперименты над животными с использованием воображаемых пыточных приспособлений восходит к Шрёдингеру. Воображаемые эксперименты помогали развивать физику в условиях отсутствия экспериментальной базы.}*

Если мы рассматриваем вероятность двух независимых событий, то вероятность записывается при условии, что к моменту наступления события A событие B произошло или наоборот. 
$((1-\mu)z^{-1}{P(A)} + \mu \cdot P(A))P(B)$, где $z^{-1}$ - оператор задержки на единицу времени. Под $\mu \in [0,1)$ в этом выражении будем понимать групповую задержку непрерывной функции сигнала A. Задержка на выходе обусловлена начальным значением $e[0]$. *{не могу с уверенностью сказать. Дело в том что вопрос когда определяется в каждый момент. А вот выходное значение из квантователя будет зависеть от начального значения ошибки. Таким образом вместе с выражением для вероятности, надо рассматривать деквантизатор}*

Деквантизатор выполняет действие $1+z^{-1}$ суммирует сигнал на первом и втором такте, т.е. $((1-\mu)z^{-1}{P(A)} + \mu \cdot P(A))$ 

В нашем рассмотрении мы использовали метод округления floor(x). Можем использовать метод округления  - к ближайшему целому, а остаток считать на интервале $[-0.5,+0.5)$. Метод расчета остатка на интервале $[0,1)$ имеет выигрыш - в этом случае расчеты можно производить в числах с фиксированной точкой или в вещественных числах полагая целую и дробную части числа, как выходное значение и остаток. 

Если задержку $\sigma$ измерять на интервале $\sigma \in [-1/2, +1/2)$, тогда полная вероятность детектирования кванта 
$$(1/2-\sigma)z^{-1}{P(A)} + (1/2+\sigma) P(A) = P(\bar{A})z^{-1}P(A) + P(A)z^{-1}P(\bar{A})$$

соответствует детектированию одного из фронтов импульса: спадающего или нарастающего.
<!--
Аналогия из Дирака[^2]: если $\sigma$ некоторый оператор над волновой функцией - плотностью вероятности, удовлетворяет условию $\sigma^2=1$, то 
$$(1/2-\sigma)|\psi\rangle + (1/2+\sigma)|\psi\rangle = |\psi\rangle$$
-->

**Определение математического ожидания случайной величины через интеграл Лебега**

Пусть задано вероятностное пространство 
$(\Omega , \mathcal{A} ,\mathbf{P})$ и определённая на нём случайная величина $X$. Тройка определяет полное множество его разбиение $\mathcal{A}$ и некоторую положительно определенную, нормированную числовую характеристику -вероятность. По определению, $X \colon \Omega \to \mathbb {R}$ — измеримая функция. Если существует интеграл Лебега от ${X}$ по пространству $\Omega$, то он называется математическим ожиданием, или средним (ожидаемым) значением и обозначается 
$\mathbb{M}[X]$.
$$\mathbb{M}[X]=\int \limits_{\Omega}X(\omega )\mathbf{P} (d\omega ).$$

Для существования интеграла должно быть дано определение непрерывности на интервале. Непрерывность мы определяем через аппроксимацию, B-сплайны, через обобщенные функции с рекурсивным методом повышения степени разложения. Для перехода в дискретное пространство используется определение дельта-функции через финитные функции на интервале $C^n[0,1]$.

Если это не очевидно, следует доказать, что сумма квантованной величины на интервале $[a,b+\tau]$ равна своему интегралу на $[a,b]$ при любом $\tau$. 

## Предикат Моругина

Мы рассматриваем некоторый метод анализа и разложения физических (наблюдаемых) величин по базису положительно определенных ортонормированных функций. Любое событие можно разложить на два по принципу $(1-\mu)A + \mu \cdot B$. Моругин предполагает, что любое описание физического явления может упускать зависимость, которая в уравнении не учтена. В вероятностном (конфигурационном) пространстве размерности n мы добавляем зависимость еще от одной группы параметров (q, p). В вероятностном пространстве это соответствует иному разбиению полного множества на n+1 элементов. Можно рассматривать, как разбиение одного из элементов на два. Этот принцип позволяет выстроить коэффициенты разложения по убыванию и настраивать параметры в парах. 

Любое явление можно таким образом можно разложить на два, с параметром $\mu$, который назовем "вклад Моругина":
$$A^{(1)} = ((1-\mu)A_{0} + \mu \cdot A_{1})$$

Этот подход может применяться рекурсивно. Подход сформулирован в контексте классификации по множеству признаков для построения нейронных сетей, когда к множеству существующих предикатов добавляется еще один. Слово "предикат" - логическая функция или функция с областью значений на интервале $[0,1)$ - предположение. 

Например, при увеличении степени разложения по оператору $z^{-1}$ можно образовать последовательность
$$A^{(1)} = ((1-\mu_1)A + \mu_1 \cdot z^{-1}A)$$
$$A^{(2)} = ((1-\mu_1)A + \mu_1 \cdot z^{-1}((1-\mu_2)A + \mu_2 \cdot z^{-1}A))$$
при этом сумма вероятностей дает единицу на каждом шаге разложения, а значения вероятностей с предыдущего шага разложения остаются неизменными. 

Этот принцип мы будем использовать для построения адаптивных моделей в пространстве линейных операторов. 

## Уравнения в частных производных

*Я верю в силу математики, но частные производные меня смущают. Нам нужно научиться численно решать уравнения в частных производных в дискретном по времени пространстве и с учетом квантизации. Чтобы не путаться в частных производных нужно проследить путь, как они вводятся.*

Первичным оказывается понятие дифференциал функции нескольких переменных - вариация (изменение) функции по параметру в заданной точке пространства. Мы определяем функцию и _функционал_ в терминах языка программирования (*нынешнее поколение студентов сначала учат языки программирования, и только потом некоторые из них осваивают математику*). Функция может принимать аргументы принадлежащие математическим классам и функции определенного класса (ссылки на функции), от множества аргументов. Функции могут быть заданы аналитически и тогда выражения для производных можно упрощать. 

Дискретное пространство приводит к необходимости рассмотрения различных вариантов _квантового исчисления_. Квантовое исчисление использует разностные численные методы, основанные на конечных разностях. Помимо этого в рассмотрение добавляется представление численных производных и дифференциальных уравнений с учетом ошибки дискретизации.

Функции, которые принимают в качестве аргументов аналитические функции мы будем называть _функционалами_.

Аналитические функции по определению могут быть разложены в ряд Тейлора вблизи выбранной точки и по базису полиномов на конечном интервале. Аналитичность - понятие растяжимое и в разных разделах математики определяется немного иначе (см. аналитичность вещественных функций немного отличается от аналитичности в комплексной плоскости, по Коши, по Риману). Например аналитичность может потребовать разложение в ряд по производным. Математический класс функций можно определить, как $C^n[a,b]$ - класс n-раз дифференцируемых непрерывных функций заданных на интервале. 

В дискретной математике аналитическая функция на интервале может быть представлена аппроксимацией - разложением по полиномам данной степени. В общем случае - разложение по базисным функциям. Важным классом функций является класс обобщенных функций заданных на интервале $C^n[a,b]$. Переход от непрерывных функций к дискретным строится на базе понятия обобщенных и финитных функций (функции обращаются в ноль вне интервала, а функции при этом определяются как функционалы по плотности распределения).
<!-- Обобщение размазывает понимание. Всегда в голове надо держать какой-то пример или набор примеров, чтобы легко ориентироваться в абстрактных понятиях. -->

$$\frac{d}{dt}f(q,p;t) = \frac{f(q,p;t_n)-f(q,p;t_n-\tau)}{\tau} + o(f)$$
это справедливо только если q и p не зависят от времени. Если q(t) и p(t) - зависят от времени, то надо учитывать в определении зависимость от q, p:
$$\frac{d}{dt}f(q,p;t) = \frac{f(q(t_n),p(t_n);t_n)-f(q(t_n-\tau),p(t_n-\tau);t_n-\tau)}{\tau} + o(f)$$

Если функция q(t), p(t) задана аналитически (непрерывна и дифференцируема), можно посчитать производную по параметру ${\partial q \over \partial t}$ и ${\partial p \over \partial t}$. В первом прибилжении мы могли бы считать производную полагая q(t) - линейной зависимостью, в пределе $\tau \to 0$. 

Если q и p зависят от времени, то полная производная будет включать производные от функций 
$$\frac{d}{dt}f(q,p;t) = \frac{\partial f}{\partial t} + \sum_i{\left[\frac{\partial f}{\partial q_i} \frac{\partial q_i}{\partial t} + \frac{\partial f}{\partial p_i} \frac{\partial p_i}{\partial t}\right]}$$

Можно ли напрямую использовать такое же определение в дискретной математикие - нет. Потому что выражение для полной производной это линейное приближение от разложения в ряд по производным. Производная вводится как предел, при $\tau \to \infty$. В дискретной  математике возникает ошибка. Нам нужен метод который минимизирует ошибку таким образом, чтобы интеграл ошибки был ноль.

**Ве́кторное по́ле** — это отображение $\vec{F}: \mathbb{R}^n \to V$, которое каждой точке пространства ставит в соответствие вектор с началом в этой точке. 

*Векторное поле исторически происходит из работ Фарадея, и далее попадает в электродинамику, в работы Максвела, Гиббса. Как построить векторное поле?*

В евклидовом пространстве можно определить функцию (функционал) от координат и времени.
В каждой точке пространства мы можем определить направление движения (при каких вариациях функционал становится меньше), направление, в котором - градиент поля становится больше/меньше. Для этого надо сравнивать значения функции во всех окружающих точках (дискретного) пространства $\{x\pm h, y\pm h, z\pm h\}$  и смотреть разницу. Используя набор частных производных (вариаций) $\{\partial_x, \partial_y, \partial_z\}$  можно составить вектор направления - градиент поля. 

**Градиент** — важнейшая и простейшая операция, позволяющая получить векторное поле из скалярного поля. Полученное применением такой операции к скалярному полю f векторное поле называется градиентом f:

```math
\operatorname{grad} f= {\partial f \over \partial x} \vec{e_x} + {\partial f \over \partial y} \vec{e_y} + {\partial f \over \partial z} \vec{e_z}~,
```
где $\{\vec{e_x}, \vec{e_y}, \vec{e_z}\}$ - базисные вектора. Оператор "набла" ("atled" - перевернутая греческая дельта) ввел сэр Гамильтон. 
Набла- векторный оператор:
```math
\vec\nabla = {\partial \over \partial x} \vec{e_x} + {\partial \over \partial y} \vec{e_y} + {\partial \over \partial z} \vec{e_z}~,
```
Оператор "набла" можно применить к любой скалярной функции или к векторной функции, используя определения скалярного и векторного произведения. 

В операторной форме: $\operatorname{grad}f = \nabla f$.

Вариационное исчисление - основа для построения теоретической физики. Из вариационного исчисления рождается теоретическая механика в формализме Лагранжа и формализме Гамильтона. Оператор набла - основной инструмент описания векторных полей.

Мы вводим понятие действие $S$. Это некоторый функционал в координатах пространства, можно сказать функционал задает траекторию движения твердого тела (материальной точки) или поверхность вдоль которой осуществляется движение. У материальной точки есть свой вектор движения, который можно описать как производную. Поверхность можно описать производной - касательной к поверхности вдоль траектории и охарактеризовать производной ${\partial S \over \partial \vec{q}}$. 

*Как определить производную вдоль вектора? Повернуть систему локальных координат вдоль вектора или спроецировать производные на направления вектора? Поворот системы координат - это наложение (ортогональных) матриц преобразования. Производную можно рассматривать в локальной системе координат, развернутой вдоль направления движения. Тогда производная должна быть преобразована в систему координат наблюдателя с использованием матриц аффинного преобразования. Аффинные преобразования выполняются над точками с использованием координат,и матриц вращения. Матрицы вращения можно составлять, как поворот на заданный угол в плоскости с заданной нормалью. Вращение может быть описано с использованием операции векторного произведения. Преобразование методом "спроецировать" определяется операцией скалярного произведения векторов заданной в евклидовом пространстве.* 

<!--
*Вот тут и есть самое опасное место - как определить производную вдоль вектора. Какие идеи? Повернуть систему координат или спроецировать производные вдоль направления вектора? Предлагаю использовать операцию скалярного произведения - получить проекцию вектора скорости $\dot{q}$ на скорость касательную к траектории $p$ - скалярное произведение векторов $\dot{q}$ и $p$.*
```math
\langle \dot{q}, p\rangle = \sum_{i}{\dot{q}_i \cdot p_i}~
```
так можно определить скалярное произведение в ортогональных координатах, в евклидовом пространстве. Физический смысл такого определения - кинетическая энергия в классической механике. -->

Аналогом производной для векторного поля в евклидовом пространстве выступает тензор составленный из частных производных (_якобиан_), который в декартовых (ортонормированных) координатах имеет вид:
```math
J=
\begin{bmatrix}
\dfrac{\partial F_{x}}{\partial x} & {\dfrac {\partial F_{x}}{\partial y}} & {\dfrac {\partial F_{x}}{\partial z}}\\
\dfrac{\partial F_{y}}{\partial x} & {\dfrac {\partial F_{y}}{\partial y}} & {\dfrac {\partial F_{y}}{\partial z}}\\
\dfrac{\partial F_{z}}{\partial x} & {\dfrac {\partial F_{z}}{\partial y}} & {\dfrac {\partial F_{z}}{\partial z}}
\end{bmatrix}.
```
**Дивергенция** - След матрицы (Якобиана) является инвариантом относительно преобразований системы координат:

$$\operatorname{div} \mathbf {F} ={\frac {\partial F_{x}}{\partial x}}+{\frac {\partial F_{y}}{\partial y}}+{\frac {\partial F_{z}}{\partial z}}.$$
Это же выражение можно записать с использованием  оператора набла и скалярного произведения: $\operatorname{div} \mathbf{F} =\nabla \cdot \mathbf{F}.$

**Ротор** — векторная характеристика вихревой составляющей векторного поля. Это вектор с координатами
```math
\operatorname {rot} \mathbf {F} =\left({\frac {\partial F_{z}}{\partial y}}-{\frac {\partial F_{y}}{\partial z}}\right)\vec{e_x} +\left({\frac {\partial F_{x}}{\partial z}}-{\frac {\partial F_{z}}{\partial x}}\right)\vec{e_y} +\left({\frac {\partial F_{y}}{\partial x}}-{\frac {\partial F_{x}}{\partial y}}\right)\vec{e_z} ,
```
Ротор определяется через векторное произведеление: $\operatorname{rot} \vec{F} =\vec{\nabla } \times \vec{F}$.

И еще ряд свойств дифференциальных операторов второго порядка:
$$\operatorname{div}(\operatorname{grad} f)=\nabla\cdot (\nabla f)$$
$$\operatorname{rot}(\operatorname{grad} f)=\nabla\times(\nabla f)$$
$$\Delta{f} = \nabla^{2} f$$
$$\operatorname{grad}(\operatorname{div} \vec{v})=\nabla (\nabla \cdot \vec{v})$$
$$\operatorname{div} (\operatorname{rot} \vec{v})=\nabla \cdot (\nabla \times\vec{v})$$
$$\operatorname{rot} (\operatorname{rot} \vec{v})=\nabla \times(\nabla \times\vec{v})$$
$$\Delta{\vec{v}}=\nabla^{2}\vec{v}$$

Мы представили операторы, которые возникают в уравнениях динамиики.

*Тема с якобианом не раскрыта. Надо ввести понятие смешанной производной. Поворот системы координат с матрицами вращения следует рассматривать в контексте гамильтоновой динамики с использованием алгебры кватернионов или матриц перестановок.* 

## Функционал действие

Функционалы это функции множества переменных, аргументом которых может быть функция. Функционалы строятся на вариационном исчислении, вместо понятие дифференциал и полная производная вводится понятие вариация функционала. Задача вариационного исчисления поиск экстремума - минимизация функционала. 

В классической (теоретической) механике вводится понятие действие. *Действие* является математическим функционалом, который берёт в качестве аргумента траекторию движения физической системы, уравнение полной энергии и возвращает в качестве результата вещественное число. 

Важным классом функционалов являются линейные функционалы, которые надо рассматривать в контексте функционального анализа в связке: линейные функционалы - линейные операторы. 

Функционалы рассматриваются в интегральном виде в задаче минимизации отклонения от уравнения движения вдоль траектории или по поверхности. 


## Вариационное исчисление

Метод Эйлера. Уравнение Эйлера.
Задача Лагранжа. Преобразование Лежандра. Уравнение Якоби. 
Численные методы. 

Простейшей задачей вариационного исчисления является поиск экстремума в задаче
```math
S[x(\cdot)] = \int \limits_{t_0}^{t_1} F(x(t),\dot{x}(t), t) ~dt
```
Экстремум ищется среди множества возможных (*аналитических или обобщенных?*) функций непрерывно дифференцируемых $x \in C^n[t_0,t_1]$ на конечном интервале.

## Операторы в дискретной математике

Состояния системы мы рассматриваем как последовательность при дискретном времени - Эволюция состояния системы во времени, - это последовательное наложение оператора на вектор состояния. Состояние задается вектором координат и вектором скоростей. Оператор это некоторое преобразование над состоянием системы. Оператор в дискретной математике выполняет преобразование состояния за один такт времени. 

$$\Delta{f_{n}} =\frac{\partial f}{\partial t} = \frac{f(x_n;t_n) - f(x_n;t_n-\tau)}{\tau} + o(f)$$
Мы применяем оператор задержки $z^{-1}$ 
$$\Delta{f_{n}} =\frac{\partial f}{\partial t} = \frac{1-z^{-1}}{\tau}f_n$$
$$\Delta^2{f_{n}} =\frac{\partial^2 f}{\partial t^2} = \frac{1-2z^{-1}+z^{-2}}{\tau^2}$$

В этом определении есть своя неточность. Неточность связана с понятием групповая задержка сигнала. Ценртральные раницы не создают групповую задержку, конечные разности создают. На каждом операторе $(1 \pm z^{-1})$ возникает групповая задержка в половину такта. Эту задержку можно измерять в фазовом пространстве цифрового фильтра. 
$$\frac{(1+z^{-1})}{2}Y = \frac{(1-z^{-1})}{\tau}X$$
Я бы вот так записал производную с фазовой задержкой $\tau/2$. Передаточная функция такого оператора:
$$H(z) =  \frac{2}{\tau} \frac{1-z^{-1}}{1+z^{-1}}$$

Этот оператор легко превратить в алгоритм, положим $\tau=1$:
```c
y = 2*(x - zx)-y;
zx = x;
```

левые правые конечные разности и центральные разности можно определить так:

$$\Delta^{-}{f_n} =\frac{\partial f}{\partial x} = \frac{f(x_n) - f(x_n-h)}{h} + o(f)$$
$$\Delta^{+}{f_n} =\frac{\partial f}{\partial x} = \frac{f(x_n+h) - f(x_n)}{h} + o(f)$$
$$\delta{f_n} =\frac{\partial f}{\partial x} = \frac{f(x_n+1/2~h) - f(x_n-1/2~h)}{h} + o(f)$$

Ошибку можно уменьшить, если рассчитывать производную от интерполяционного полинома. Достаточно использовать полиномы третьей степени, заданные по трём или четырем точкам. 

Вторые производные задаются рекурсией через первые $\Delta^2{f_n} = \Delta(\Delta f_n)$
$$\Delta^{2}{f_{n}} = \frac{\Delta{f_{n}} - \Delta{f_{n-1}}}{h}$$
$$\delta^{2}{f_{n}} = \frac{\delta{f_{n+1/2}} - \delta{f_{n-1/2}}}{h}$$

Конечные разности можно представить в операторной форме в виде разложения по степеням $z$, по задержкам. 

$$H(z) = \sum_{k=0}^n b_k z^{-n}$$

Оператор в такой форме мы будем называть цифровым фильтром с конечной импульсной характеристикой (КИХ). 

Разложение функции в ряд фурье по производным приводит к определению оператора (цифрового фильтра) с бесконечной импульсной характеристикой (БИХ). 

$$H(z) = \sum_{k=0}^\infty b_k z^{-n}$$

*Что такое импульсная характеристика. Откуда она берется и почему импульсная характеристика в форме интеграла или ряда определяет эволюцию системы. см. курс Мат.физики или теорию линейных стационарных систем (LTI). Автоматикам полагается курс по теории LTI и по устойчивости систем.*

Оператор с бесконечной импульсной характеристикой 
$$Y = H(z)X$$
можно представить в дифференциальной форме как разницу
$$Y - \alpha z^{-1} Y = H'(z)X$$

$$Y - \alpha_1 z^{-1}Y - \alpha_2 z^{-2} Y = H''(z)X$$
Над операторами задержки действует та же алгебра, что над полиномами, их можно складывать и перемножать. Из задержек можно составлять базисные полиномы. В общем случае мы говорим про разложение по базису собственных функций оператора. Функции - аналитические и их всегда можно представить, как разложение по задержкам (степеням z).

В общем виде дифференциальный оператор запишется в виде
$$A(z) Y  = B(z) X$$
Хотя мы не определили, что такое обратная операция для оператора, можем символически записать в виде отношения.
$$Y  = \frac{B(z)}{A(z)} X$$
Операторы в общем случае не являются коммутируемыми. Но если операторы, как полиномы можно раскладывать на сомножители (факторизация), то и сокращать и приводить к общему знаменателю можно по тем же правилам, что и дробно-рациональные функции. Обратный оператор можно определить для дробно рациональной функции.

Над линейными операторами и рациональными операторами можно выстроить ассоциативную алгебру (операция сложения и наложения операторов). При некоторых оговорках операторы могут быть коммутативными или антикоммутативными. 

Операторы существуют в собственной системе координат. Вектор состояния системы необходимо преобразовать из данной системы базисных функций в собственную и обратно. Над пространством собственных функций надо выстроить аффинное пространство и определить преобразование.

<!-- Над операторами вводится еще одна операция - _коммутатор_ операторов. Коммутатор следует отнести к дифференциальным операторам и сравнить с определением ротора,  векторного произведения. В курсе надо рассмотреть разложение в ряд по коммутаторам - есть и такое. В общем виде в ряд по дифференциальным операторам, также можно составлять ряды с использованием дифференциальных операторов. -->

### Древняя философия

Чтобы понимать что такое операторы предлагаю рассмотреть их вне математики, т.е. попробовать ввести на оснвое философксих суждений, подобно тому как атомисты объясняли суть вещей.
Давайте представим, что нет никакой математики и ее нужно определить из философских соображений.
Мы вводим понятие состояние системы и понятие абстрактный оператор, который выполняет преобразование над состоянием системы. Любой оператор я могу представить как разложение в две стороны: со стороны результата и со стороны причины. Определение симметрично. Направление течения времени не важно. Можно перевернуть причину и следствие - оператор останется прежним (перевернутым). Я введу некоторый аналог операции импликации. Это операция следования - операция над причинно-следственными связями. 

Y <= X(z) – это не решенная задача, это запись промежуточного результата, который говорит примерно следующее: есть некоторое дерево причинно следственных связей Z которое приводит к Y. 

Мы считаем, что все операторы обратимы, т. е. для любого оператора можно построить обратный. Обратимость причинно следственных связей достигается при полноте квантового состояния. Для прямого утверждения запишем $Y<= X(z)$. Мы говорим, что существует обратное представление $Y(z) => X$. И существует множество промежуточных состояний, для каждого последовательного преобразования. Если выражение можно разложить на последовательность событий, то это каскад: $Y <= X_1(z) X_2(z)$. Тогда и обратное преобразование можно представить, как каскад: $Y_2(z)Y_1(z) => X$. 

В общем случае любой процесс в каскаде операторов можно представить, как стадию разложения по причинно следственным связям: Y(z) <=> X(z). 

Операторы — рациональные функции и это никакой не вывод из математики, это свойство полноты описания системы. Рациональные функции — это такие у которых и левая и правая часть уравнения — линейные операторы, каскад линейных операторов слева и справа.

Разложение по времени в хронологическом порядке. Что является неделимым оператором, -- атомарная операция задается атомарной формулой. Эту операцию можно описать «импликацией» причиной и следствием или отношением причины и следствия.
$$y - \alpha z^{-1}y = \bar{\alpha}X(z)$$
-- вот элемент разложения моего оператора в каскад. Тут я использую некоторую пропорцию дробь $(\alpha)$ и дополнение до полного.

$$Y = \frac{\bar{\alpha}X(z)}{1 - \alpha z^{-1}}$$
 -- вот я их так и буду записывать в каскады. 

Я скажу физикам - атомистикам, что изучение нашего мира может быть сведено к распознаванию коэффициентов при разложения в каскад. Но так они не умеют думать не привыкли, надо предложить другое разложение. Аддитивное разложение нужно, чтобы к существующему разложению, можно было просто «добавить» зависимость от еще одного параметра, который мы раньше не учитывали или оно это явление не проявлялось.

Второе проявление операторов — аддитивное. Я опять вспомню некоторый концепт. Допустим в известном нам физическом явлении есть некоторая зависимость, которую мы не учли. Мы добавим предикат с коэффициентом, который нужен в данный момент времени, чтобы квантовый эффект не давал целую ошибку и оставался в диапазоне значений $[0,1)$. Как выглядит предикат?

$$Y = \frac{\bar{\alpha}C}{1 - \alpha z^{-1}}$$
К существующему аддитивному разложению надо добавить одно слагаемое, которое не меняет разложение при $\alpha_k=0$. 

*К чему приводит  такая философия - к нормальной форме дифференциальных уравнений.*

Я решил добавить в рассмотрение тему изоморфного представления полиномов. Разложение в ряд по степеням оператора $\{z^{-k}\}$ можно представить в виде разложения по другой системе базисных полиномов (аналитических функций) той же степени. Все разложения данной степени являются изоморфными, между ними можно рассчитать матрицу аффинного преобразования. Как бы ни был выражен оператор данной степени мы его можем привести к некоторому каноническому виду.

* Бернштейн предложил базисные полиномы $\{z^{-k}(1-z^{-1})^{n-k}\}_{k=0}^{n}$ из теории вероятностей.
* Существует базис степенной $\{z^{-k}\}$ и базис в полиномах Тейлора $\{z^{-k}\}$ .
* Я предложил базис разложения, который неожиданно следует из уравнений в конечных разностях для цифровых фильтров: $(1-z^{-1})^2$, $(1-z^{-2})$, $(1+z^{-1})^2$
* Есть еще не исследованный базис smooth-функций.
* Сущесьвуеь множество ортогональных полиномов

Есть много разных базисов, которые следуют как набор собственных функций для решения конкретного дифференциального уравнения. Это полиномы Ньютона, Лагранжа, Бернштейна, Тейлора, которые относятся к интерполяциям и полиномы Эрмита, Якоби, Лежандра, Чебышева... которые относятся к решениям уравнений в частных производных.
Подробнее см. ортогональные полиномы.

У Гильберта было много проблем. см. 19-я проблема Гильберта - всегда ли решение дифференциального уравнения (эллиптического типа) аналитично - сводится к разложению по ортогональным полиномам.

Хочется в данном контексте упомянуть и 13-ю проблему Гильберта. Которая касалась представимости функций нескольких переменных в виде суперпозиции нескольких непрерывных функций двух переменных.

Проблема в действительных числах была решена В. И. Арнольдом совместно с А. Н. Колмогоровым [KAT57], доказавшими, что любая непрерывная функция любого количества переменных представляется в виде суперпозиции непрерывных функций одной переменной и функции двух переменных(сложением):

$$f(x_{1},\dots ,x_{n})=\sum _{q=0}^{2n}\Phi _{q}\left(\sum _{p=1}^{n}\psi _{q,p}(x_{p})\right)~.$$

Чтобы не возникало иллюзий надо помнить, что функции $\psi_{q,p}$ определены на вероятностном базисе, на интервале $C^n[0,1] \to \mathbb{R}$. 
На интервале мы можем взять B-сплайны (полиномы Бернштейна, например) и получить многомерное разложение функции по базисным полиномам. 

Назовем вложенную функцию вида 
$$\sum_{k=1}^{n}\psi _{q,k}(x_{k})$$
обобщенной переменной, которую мы могли бы интерпретировать как функция распределения вероятности. Для описания системы на множестве действительных чисел нам понадобится 2n+1 обобщенных переменных.

Квантовая теория (теория функции в гильбертовом пространстве) предлагает рассматривать всякую функцию в виде преобразования вектора состояния в собственную систему - вектор из n комплексных переменных. К вектору в собственной системе координат применяются линейные операторы со скалярами на множестве комплексных чисел и полученный вектор обратно преобразуется в систему наблюдателя. 

См. теория представлений и группы Ли
> **Теория представлений** — раздел математики, изучающий абстрактные алгебраические структуры с помощью представления их элементов в виде линейных преобразований векторных пространств. Среди объектов, поддающихся такому описанию, находятся группы, ассоциативные алгебры и алгебры Ли.

Мы говорим об архитектуре вычислительной сети, которая позволяла бы численно решать задачи динамики на безразмерных (безмасштабных графах). Архитектура состоит из линейных операторов (в общем виде дробно-рациональных) и матричных преобразований - аффинных (обратимых) преобразований. 

## Дискретное преобразование Лапласа

Метод Дирака, или как избавиться от интегралов 

*{стоило изучать математику}*

Методу Дирака я бы противопоставил теорию числовых рядов. Изучение числовых рядов дает два метода: метод характеристических функций и метод производящих функций ряда. Этого может оказаться достаточно. Интегральное исчисление в дискретной математике не понадобится и дельта функции не понадобятся, чтобы вернуться обратно от интегрального представления к рядам. 

Пусть дискретный сигнал рождается в виде ряда чисел с заданным интервалом времени. $Т_s$ – период дискретизации. Тогда надо ввести специальную решетчатую функцию со свойствами $\delta$-функции Дирака, которая показывает, что время дискретно. Тогда применяя преобразование Лапласа к определению $\delta$-функции — бесконечно дифференцируемой аналитической абстракции, которая тем не менее удовлетворяет требованиям обобщенной функции на интервале $[0,T_s]$ и обладает всеми свойствами чтобы назвать ее аналитической - гладкой и бесконечно дифференцируемой, получаем выражение дискретного преобразования:
$$\mathrm{D}\{x(t)\} = \sum_{n=0}^{\infty} x(n T_s)\cdot e^{-snT_s}$$ 
-- дискретное преобразование Лапласа. Преобразование Лапласа переводит задержки в экспоненты. А заменой $z = e^{sT_s}$ мы переходим в пространство задержек к полиномам составленным из задержек
$$\mathrm{Z}\{x(t)\} = \sum_{n=0}^{\infty} x(n T_s)\cdot z^{-n}~.$$

Может быть математики чувствуют какое-то разумное объяснение за такими подменами. Я — нет. Z- пространство это никакие не операторы, это просто замена формальных переменных чтобы буквы совпадали, а экспоненты были представлены полиномами. На самом деле мы получаем все тоже самое и без интегрального исчисления без сходимости дельта функций. Никто не мешает начать математику сразу с понятия оператора задержки, из производящих функций числовых последовательностей. Этой буквой (z) мы обозначаем задержку на один такт. А сами ряды не используют операцию подстановки значения, z - символьная переменная, как символ мнимой единицы в комплексных числах. Над задержками — операторами действует своя алгебра, как над полиномами. Сначала мы определяем свойства операторов. Операторы образуют группу по отношению к операции «каскад», ассоциативную алгебру по двум операциями (сложение и каскад-операция типа умножения). Операторы линейные со своими скалярами из множества чисел $\mathbb{R}$ или $\mathbb{C}$. Как для дробных рациональных функций расширенном комплексной плоскости всегда существуют обратные преобразования. Я бы отнес операторы к классу конформных отображений. Конформные отображения это свойство дробно-рациональных функций в теории функции комплексного переменного.

Числовой последовательности $\{x(n T_s)\}$ можно сопоставить характеристическую и производящую функцию. Из понятия характеристические функции выводится преобразование Фурье по тригонометрическим функциям и преобразование Лапласа, а из производящий функций мы получаем Z-пространство. Это не математика это просто символьная запись утверждения "числовая последовательность дискретна во времени".

### Преобразование оператора в алгоритм

Мы вводим класс - цифровой фильтр. Который описывается, как два конечных набора коэффициентов B и A. Оператор определяется состоянием, которое будет описываться вектором Z.

*{дописать}*

## Минимизация функционала

Допустим у нас задано уравнение движения $f(x, y) = 0$.

$$\frac{\partial f(x,y)}{\partial x} = \frac{f(x_n,y_n) - f(x_n-1,y_n)}{h} + o(f)$$
$$\frac{\partial f(x,y)}{\partial x} = \frac{f(x_n+1,y_n) - f(x_n,y_n)}{h} + o(f)$$

```c
do {
    t = t + tau;
    err_0 = o_f + f(x,   t);
    err_p = o_f + f(x+h, t);
    if (abs(err_p) < abs(err_0)){
        o_f = err_p;
        x = x+h;
    } else {
        o_f = err_0;
    }
} while(...)
```
В расчете мы должны сравнивать два варианта, с вариацией, выбирать движение с наименьшей ошибкой. На каждом шаге мы минимизируем ошибку. Это одномерный случай. 
В случае размерности n, мы ищем вариацию (сочетание изменений параметров) при которой ошибка минимальна
```c
const delta[N] = {{1,0,0},{0,1,0},{0,0,1},{-1,0,0},{0,-1,0},{0,0,-1},{1,1,0},...,{-1,-1,-1}};

err_m = err_0;
m = -1;
for (int i=0; i<N; i++){
    err_i = o_f + f(q + delta[i], t);
    if (abs(err_i) < abs(err_m)){
        err_m = err_i;
        m = i;
    }
}
if (m>=0){
    o_f = err_m;
    q = q + delta[m];
} else {
    o_f = err_0;
}
```
Вариантов много. Можно придумать алгоритм, который минимизирует число вариантов в частных случаях. Например если известно что какой-то из параметров монотонно возрастает, это снижает число вариантов. 

Задачу классической механики мы можем перефразировать в дискретной математике. Допустим заданы координаты и скорости в начальной и конечной точках траектории, на каждом интервале движения с фиксированными точками начала и конца траектории. Необходимо описать эволюцию системы при дискретном времени. Эволюция описывается отклонением от траектории на каждом шаге времени. Система должна пройти путь от начального до конечного состояния и при этом мы требуем минимизировать суммарную ошибку и ошибку на каждом шаге - отклонение от заданного уравнения движения. В квантовой механике (в нашей постановке) мы будем требовать еще одного - действие должно быть обратимым, т.е. пройти траектории можно в обоих направлениях с одинаковыми ошибками в каждой точке.

**Траектория линейная** 

Линейный сплайн задается через две точки P0 P1 и время перемещения. Из этих условий мы можем составить уравнение движения

$$x = \frac{(x_1-x_0)}{(t_1-t_0)} t + x_0$$
$$L(x,t) = At - Bx +L_0$$
Это траектория, отклонение должно минимизироваться. Т.е на каждом шаге (интервале движения) алгоритма $\delta \int L dt$ должно минимизироваться. Сумма всех отклонений, должна давать ноль. 
Алгоритм выполняет движение вдоль траектории.
```c
for(t=t_0; t < t_1;t++){
    err += A;
    if (err>B/2){
        err -= B;
        x++;
    } 
}
```
Можно сформулировать более общее правило $A={\partial L \over \partial t}$, $-B={\partial L \over \partial x}$. 



**Траектория задана сплайном** 

Квадратичный сплайн задается через точки P0 P1 и производные в точках $P'(0) P'(1)$. Производные могут высчитываться от соседних или узловых точек.

Для вычисления производной в точке может применяться билинейная (бикубическая) интерполяция. Для того чтобы стыковать функции и производные на границах интервала требуется кубическая интерполяция функции должны принадлежать $C^2[a,b]$ - непрерывные и дважды дифференцируемые на интервале. Траекторию движения можно задать сплайном, но этого не достаточно, поскольку сплайн можно рассчитать с произвольной скоростью движения вдоль траектории. Чтобы однозначно описать движение вдоль траектории необходимо задать функцию скорости на $C^2[a,b]$. 

В общем случае движение можно было бы описать функционалом на векторном пространстве и двумя функциями, т.е задать траекторию и задать скорость вдоль траектории
$L(q, \dot{q}, t)$. 


<!--
Полная энергия - сумма потенциальной и кинетической, сохраняется. Это мы и запишем в виде функционала. Интеграл движения вдоль траектории - действие

Интеграл движения это отклонение от траектории заданной уравнением. Допустим что $\mathcal{L}(q, \dot{q}; t)$ задает отклонение от траектории, тогда сумма всех отклонений при движении вдоль траетории - ноль. Если движение задано из точки А в точку B вдоль траектории, то 
$$S = \int_{A}^{B} \mathcal{L}(q, \dot{q}; t) dt = 0$$ 
Тоже самое в дискретном пространстве мы положим - вариация действия минимизируется на каждом неделимом интервале перемещения.
$$\delta S = \int_{a}^{b} \mathcal{L}(q, \dot{q}; t) dt + o(S)= 0$$ 

Функционал действия мы раскладываем на две компоненты: траектория заданная уравлением и координты точки. Чтобы движение удовлетворяло уравнению при вариации скорости и при вариации поолжения. Пусть H(q, p) - траектория в некоторых координатах q и p - импульс (скорость). Траектория одновременно должна давать 

$$-{\partial H \over \partial q} = \dot{p}, \quad {\partial H \over \partial p} = \dot{q}$$


*смешанная производная*
-->