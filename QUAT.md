# Кватернионы и группа вращения

Кватернио́ны (от лат. quaterni, по четыре) — система гиперкомплексных чисел, образующая векторное пространство размерностью четыре над полем вещественных чисел. Математический класс обозначается символом $\mathbb{H}$. Предложены Уильямом Гамильтоном в 1843 году.

Кватернион представляет собой пару $\left( a,\vec{u} \right)$, где $\vec{u}$ — вектор трёхмерного пространства $\mathbb{R}^3$, а $a$ — скаляр, $\mathbb{R}$.

Кватернионы можно определить, как сумму, разложение по ортогональным векторам
$q=a + b i + c j + d k$,
где $a,b,c,d$ — вещественные числа, а $i,j,k$ — мнимые единицы со следующим свойством: 
$i^{2}=j^{2}=k^{2}=ijk=-1$. Откуда следуют правила умножения единичных векторов: $jk=i, ik=j, ij=k$.

*Почему бы не слепить по тому же принципу другую систему, с двумя мнимыми единицами, $i^{2}=j^{2}=ij=-1$?*

Кватернионы образуют математическую структуру типа Кольцо над множеством кватернионов с определенной операцией сложения и умножения. 

Операции сложения определены следующим образом:
$$\left(a,{\vec{u}}\right)+\left(b,{\vec{v}}\right)=\left(a+b,{\vec{u}}+{\vec{v}}\right).$$

Произведение определяется следующим образом:
$$\left(a,{\vec {u}}\right)\left(b,{\vec {v}}\right)=\left(ab-{\vec {u}}\cdot {\vec {v}},a{\vec {v}}+b{\vec {u}}+{\vec {u}}\times {\vec {v}}\right),$$
где $\cdot$ обозначает скалярное произведение векторов, а $\times$ — векторное произведение.

Из определения следует:
$$\left(a,0\right)\left(0,{\vec {v}}\right)=\left(0,{\vec {v}}\right)\left(a,0\right)=\left(0,a{\vec {v}}\right),$$
$$\left(a,0\right)\left(b,0\right)=\left(ab,0\right),$$
$$\left(0,{\vec {u}}\right)\left(0,{\vec {v}}\right)=\left(-{\vec {u}}\cdot {\vec {v}},{\vec {u}}\times {\vec {v}}\right).$$

Заметим, что:
* Алгебраические операции в кватернионах обладают свойством дистрибутивности;
* Антикоммутативность векторного произведения влечёт некоммутативность произведения кватернионов.

Сопряженный кватернион
$$\overline{(s,\vec{v})}=(s,-\vec{v})$$
Обратный кватернион по отношению к операции умножения:
$$(s,\vec{v})^{-1}={\frac {(s,-\vec{v}) }{s^{2}+|\mathbf {v} |^{2}}}$$

так кватернионы мы определили через $\{R,V(R^3)\}$ множество скаляров и множество векторов, образующих линейное пространство. 

## Матрицы перестановок

Кватернионы можно определить, как комплексные матрицы 2x2 следующего вида с обычными матричными произведением и суммой [3]:
```math
\begin{pmatrix*}[r]
      \alpha &\beta \\
-\bar{\beta} &\bar{\alpha}
\end{pmatrix*} = 
\begin{pmatrix*}[r]
 a+ib & c+id\\
-c+id & a-ib
\end{pmatrix*},
```
где
$\bar{\alpha}$ и $\bar{\beta}$ обозначают комплексно-сопряжённые числа к 
$\alpha$ и $\beta$. 

* Сопряженному кватерниону соответствует сопряженная транспонированная матрица, эрмитова матрица. $\bar{q}=\bar{Q}^T$. 
* Квадрат модуля кватерниона равен определителю матрицы $|q|^2 = \operatorname{det}Q$.

Матрицы такого вида можно разложить по базису нормированных матриц(матрицы Паули):
```math
I=\begin{pmatrix}
 1 & 0\\
 0 & 1
\end{pmatrix}, \quad
\sigma_1=\begin{pmatrix}
 0 & 1\\
 1 & 0
\end{pmatrix}, \quad
\sigma_2=\begin{pmatrix}
 0 & -i\\
 i & 0
\end{pmatrix}, \quad
\sigma_3=\begin{pmatrix}
 1 &  0\\
 0 & -1
\end{pmatrix}
```

```math
\sigma_{1}^{2}=\sigma_{2}^{2}=\sigma_{3}^{2}=-i\sigma_{1}\sigma_{2}\sigma_{3}=I
```

*А вам в курсе квантовой механики рассказали, что матрицы Паули - это кватернион? Как вообще можно было ввести квантовую механику через квантование гамильтоновой механики без кватернионов? Паули предложил свой способ - через матрицы перестановок. Комплексные числа можно ввести через матрицы перестановок и гиперкомплексные числа можно ввести через матрицы перестановок. Гиперкомплексные числа - абстрактный математический класс, комплексные числа образованные от комплексных чисел.*

Кватернионы можно ввести через три комплексные матрицы с мнимой единицей j, для которых выполняется 
```math
\begin{pmatrix*}[r]j&0\\ 0 &-j\end{pmatrix*}
\begin{pmatrix*}[r]0&1\\-1 & 0\end{pmatrix*} = 
\begin{pmatrix*}[r]0&j\\ j & 0\end{pmatrix*}.
``` 
Произведению этих матриц можно сопоставить произведение символов $ij=k$. 
* Произведение единичных матриц антикоммутативно $ij = -ji$.

Квадрат каждой из этих матриц - «минус единичная матрица»: $i^2 = j^2 = k^2 = -I$. Порождаемая этими матрицами подгруппа матричной группы изоморфна группе кватернионов. 

Таким образом, матрице 
```math
\begin{pmatrix*}[r]
      \alpha &\beta \\
-\bar{\beta} &\bar{\alpha}
\end{pmatrix*} = 
\begin{pmatrix*}[r]
 a+ib & c+id\\
-c+id & a-ib
\end{pmatrix*},
```
можно сопоставить кватернион $q=a+ib+jc+kd$, где под символами мнимой единицы можно подразумевать матрицу перестановок. От матриц перестановок $\{i,j,k\}$ можно перейти к матрицам Паули: $\{i\sigma_3, i\sigma_2, i\sigma_1\}$.


## Группа вращений 

Кватернион можно определить, как вращение. 
$$q=w+x\mathbf{i} +y\mathbf{j} +z\mathbf{k} =\cos(\alpha/2)+\vec{u}\sin(\alpha/2)$$
где $\vec{u}$ — единичный вектор. Таким образом, произведение
$q\vec{v} q^{-1}$ вращает вектор $\vec{v}$ на угол $\alpha$ вокруг оси заданной вектором $\vec{u}$. 
Нормированное скалярное произведение в евклидовом пространстве - косинус угла поворота.

Более абстрактно, кватернионы принадлежат группе Ли SU(2).

**Алгеброй Ли** называется векторное пространство 
$\mathbb{L}$ над полем $K$, снабжённое билинейным отображением $\mathbb{L}^{2}\to \mathbb{L},\ \ (x,y)\mapsto [x,y]$, удовлетворяющим следующим двум аксиомам:
* $[x,y]=-[y,x]$, $[x,x]=0$;
* $[x,[y,z]]+[y,[z,x]]+[z,[x,y]]=0$ (тождество Якоби).

Другими словами, в алгебре Ли задана антикоммутативная операция, удовлетворяющая тождеству Якоби. Такая операция называется коммутатором. 

В физике группы Ли появляются как группы симметрии физических систем. Произвольная ассоциативная алгебра над $K$ с умножением: 
$(x,y) \mapsto xy$ обладает естественной структурой алгебры Ли над $K$, если определить скобку Ли через ассоциативное умножение по формуле: $[x,y]=xy-yx$, это выражение называется _коммутатором_.

Специальная унитарная группа — группа унитарных матриц заданного порядка с определителем, равным 1, и _произведением_, как групповой операцией; для матриц размером $n\times n$ группа обозначается $\mathrm{SU}(n)$.
Группа $\mathrm{SU}(n)$ имеет $n^{2}$ элементов, одна из матриц - инвариант - единичная диагональная матрица. Любое вращение можно получить, как линейную комбинацию базисных матриц.

_Теорема_. Каждое вращение в трехмерном пространстве имеет собственный вектор и собственное значение $\lambda=1$ 

*Как бы сложно не выражались, это означает что матрица поворотов в пространстве $\mathbb{R}^3$ обладает таким свойством: вращению можно сопоставить вектор нормали к плоскости и угол - скалярное произведение. Кватернион представляет собой тот самый вектор и угол.*

## Функция Гамильтона ##

**Функция Га́мильтона**, или **гамильтониа́н** — функция, зависящая от обобщённых координат, импульсов и, возможно, времени, описывающая динамику механической системы в гамильтоновой формулировке классической механики.

В квантовой механике оператор Гамильтона, определяющий поведение системы, соответствует функции Гамильтона в классической физике. Квантовый гамильтониан может быть получен просто подстановкой операторов координат и импульсов в функцию Гамильтона.
$H(p,q)$, или $H(p,q,t)$, - функция Гамильтона, где 
$p=(p_{1},p_{2},...,p_{n})$ — полный набор обобщённых импульсов, 
$q=(q_{1},q_{2},...,q_{n})$ — полный набор обобщённых координат, 
$n$ — число степеней свободы.

Гамильтонову механику следует рассматривать, как абстрактный математический класс образованный от векторного пространства $q_n, p_n \in V(\mathbb{R}^3)$. Но кажется это является некоторым упрощением, поскольку сам Гамильтон образовал пространство кватернионов над векторами. 

Уравнения Гамильтона 
$${\dot{p}}_{j}= -\frac{\partial H}{\partial q_{j}}, \quad
  {\dot{q}}_{j}=~~\frac{\partial H}{\partial p_{j}},$$

В механике $H$ можно представить, как сумму кинетической и потенциальной энергии. 

# Теоретическая физика

Предлагается рассмотреть уравнения механики в форме Ньютона, и уравнения механики в форме Лагранжа (лагранжиан) и в форме Гамильтона (гамильтониан). Все три подхода ведут к одному результату. Лагранжиан представляет одно уравнение в обобщенных координатах - систему уравнений второго порядка. Гамильтонова механика представляет систему уравнений из обобщенных координат и импульсов. В общем случае можно говорить про две переменные типа "flow" и "effort", для которых составляется система дифференциальных уравнений первого порядка, "канонических уравнений" Гамильтоновой динамики. В основе гамильтоновой динамики лежит принцип наименьшего действия. 

Действие определяется, как интеграл от функционала на конечном интервале в формулировке Лагранжа
```math
S=\int\limits_{t_1}^{t_2}\mathcal{L}(q,\dot{q},t) dt
```
где
$q=\{q_{1}, q_{2},\ldots ,q_{n}\}$ — полный набор координат, характеризующих динамическую систему,\
$\dot {q}=\{{\dot {q}}_{1},\;{\dot {q}}_{2},\;\ldots ,\;{\dot {q}}_{n}\}$ — набор скоростей (производных $q$ по времени),
$\mathcal{L}$ - функция Лагранжа.

Это абстрактные философские понятия. Нужна привязка. Можно говорить про отличие траектории заданной аналитически от множества траекторий. Лагранжевой механике соответствует уравнение Эйлера-Лагранжа. Но переход от абстрактного интеграла действие не очевиден. Можно повторят слова философского учения. Но реально в этом месте должна работать голая математика. Математический аппарат - вариационное исчилсение. 

**Уравне́ния Э́йлера — Лагра́нжа** являются основными формулами _вариационного исчисления_, c помощью которых ищутся стационарные точки и экстремумы функционалов. 

*На самом деле речь идет от принципе наименьшего действия в физике, как основной принцип вывода уравнений механики. Принцип формулировал Гамильтон и формулировал математический аппарат вариационного исчисления. Именно так рождаются уравнения. Мне кажется правильнее было бы говорить, что на основе принципа наименьшего действия можно формулировать уравнения для описания траекторий движения в классической механике.*

Или, тоже самое действие в гамильтоновой динамике:
```math
S=\int\limits_{t_1}^{t_2}\left(\sum_{i}p_{i}{\dot{q}}_{i}-\mathcal{H}(q, p, t)\right) dt,
```
где
$q=\{q_{1},\ldots ,q_{n}\}$ — полный набор координат, характеризующих динамическую систему,
$p=\{p_{1},\ldots ,p_{n}\}$ — полный набор импульсов,
$\mathcal{H}$ - функция Гамильтона.

Точная формулировка - принцип стационарности действия. Вариация интеграла действие равна нулю,
$\delta S = 0$.

Базовая идея, которая принадлежит Гамильтону - это кватернионы, аналог комплексных чисел над четырьмя переменными: действительной и тремя мнимыми. В общем случае гамильтонову механику можно рассматривать над множеством кватернионов, три мнимые компоненты кватерниона соответствуют координатам евклидова пространства, а четвертая - используется для скалярных величин. Определение "скалярного произведения" и "векторного произведения" может быть получено из правил умножения кватернионов. Современный подход - расчет динамических мультифизических систем может выполняться в обобщенных переменных типа flow и effort (q,p) с минимизацией функционала действия - суммарная энергия системы - константа. Расчеты связанные с преобразованием системы координат эффективнее выполнять в пространстве кватернионов. Однако, развитие физики шло не прямым путем, вместо кватернионов вводятся эквивалентный математический аппарат - гиперкомплексные числа, и матрицы перестановок образующих группы вращения.

Понятие функционала действия в гамильтоновой механике на множестве дискретных функций ([см авторское определение дискретности пространства](QUANT.md)) приводит к квантовой интерпретации минимизации функционала действия. Это базовый принцип квантовой механики. 

Первоначально вариационный принцип Гамильтона был сформулирован для задач механики, но при некоторых естественных предположениях из него выводятся уравнения Максвелла[4] электромагнитного поля. С появлением теории относительности оказалось, что этот принцип строго выполняется и в релятивистской динамике[5]. 

*Из своего физического образования я вынес некоторый принцип: не бывает в физике производных по времени выше первой. Есть понятие - обобщенный импульс - производная по времени от импульса есть. Есть производная по координате - скорость и есть производная по импульсу. Третьей производной не бывает! Сотрите из википедии определение рывок - это бред! Все уравнения можно представить в форме системы уравнений с первой производной по времени в левой части. Если возникает уравнение, в котором слева производная выше первой степени - надо разложить в систему из двух канонических уравнений. Мое понимание физики держится на экспериментальной физике, в которой есть только один способ записи "эмпирических уравнений": наблюдаемая физическая величина меняется, потому что..." - это выражение соответствует формуле производная по времени равна некоторой функции от множества наблюдаемых величин.*

> *Нормальная форма дифференциальных уравнений* есть наипростейшая эквивалентная форма исходных уравнений. Нормальная форма получается с помощью специальных замен зависимых и независимых переменных задачи с целью максимального упрощения структуры уравнений. 

*Другой подход - численные методы и дискретная математика. Чтобы применять физику для моделирования, ее надо раскладывать в системы уравнений первого и второго порядка. Причем, если в уравнении возникают нелинейные функции от наблюдаемых величин - это следствие того, что аналитическое (приближенное) решение одного уравнения подставили в другое уравнение - следует разложить обратно в систему уравнений, привести к нормальному виду.*

## Принцип наименьшего действия

В 1760—1761 годах, Жозеф Луи Лагранж ввёл строгое понятие вариации функции, придал вариационному исчислению современный вид и распространил принцип наименьшего действия на произвольную механическую систему. 

В 1834—1835 годах Уильям Роуэн Гамильтон опубликовал ещё более общий вариационный принцип, из которого следовали все более ранние, как частные случаи:

$$\delta {\mathcal{S}}=\delta \int\limits_{t_1}^{t_2} \mathcal{L}\left(\mathbf{q}(t), \mathbf{\dot{q}}(t), t \right)dt=0.$$
Здесь $\mathcal{L}$ — лагранжиан динамической системы, $q$ — обобщённые координаты. Гамильтон положил этот принцип в основу своей «гамильтоновой механики» и дал решение вариационной задачи в виде «канонических уравнений».

В 1835 году Гамильтон опубликовал работу «Теория алгебраических пар» (Theory of Conjugate Functions or Algebraic Couples), в которой дал строгое построение теории комплексных чисел.

В 1843 году Гамильтон ввел кватернионы. Из алгебры кватернионов рождается термин скалярное и векторное произведение. 

В вариационной задаче Лагранжа возникает производная функционала вдоль вектора 
$${\partial L \over \partial \vec{q}} = \nabla L$$

Гамильтон придумал оператор "набла":
$$\nabla ={\partial  \over \partial x} \vec{i} + {\partial  \over \partial y}\vec{j}+ {\partial  \over \partial z}\vec{k}~,$$
где $\vec{i}, \vec{j}, \vec{k}$ — единичные векторы по осям $x,y,z$ соответственно.

Оператор "набла" можно применять к скалярной части кватерниона и к векторной. Так вводится понятие градиент скалярной функции и дивергенция вектора. Векторное произведение дает ротор векторной функции. 
```math
\nabla \phi =\frac{\partial \phi}{\partial x}\vec{i} + \frac{\partial \phi}{\partial y}\vec{j}+ \frac{\partial \phi}{\partial z}\vec{k}=\operatorname{grad}~\phi,
```

```math
\nabla \cdot \vec{a} = \nabla_{x}a_{x} + \nabla_{y}a_{y}+\nabla_{z}a_{z} 
= \frac{\partial a_{x}}{\partial x} + \frac{\partial a_{y}}{\partial y} + \frac{\partial a_{z}}{\partial z}= \operatorname{div}~\vec{a},
```
```math
\nabla \times {\vec {a}}={
\begin{vmatrix}
\vec{i}  & \vec{j} & \vec{k}\\
\frac{\partial}{\partial x} & \frac{\partial}{\partial y} & \frac{\partial}{\partial z}\\
a_{x} & a_{y} & a_{z}
\end{vmatrix}}
= \left({\partial{a_{z}} \over \partial y}-{\partial{a_{y}} \over \partial z}\right)\vec{i} 
+ \left({\partial{a_{x}} \over \partial z}-{\partial{a_{z}} \over \partial x}\right)\vec{j} 
+ \left({\partial{a_{y}} \over \partial x}-{\partial{a_{x}} \over \partial y}\right)\vec{k}
=\operatorname{rot}~\vec{a}
```

Оператор Лапласа получается, как скалярное произведение операторов "набла": $\nabla\cdot\nabla = \Delta$.
В декартовых координатах оператор Лапласа определяется следующим образом:
```math
\Delta ={\partial^2 \over \partial x^2}+{\partial^2 \over \partial y^2}+{{\partial^2} \over \partial z^2}.
```

И еще ряд свойств дифференциальных операторов второго порядка:
$$\operatorname{div}(\operatorname{grad} f)=\nabla\cdot (\nabla f)$$
$$\operatorname{rot}(\operatorname{grad} f)=\nabla\times(\nabla f)$$
$$\Delta{f} = \nabla^{2} f$$
$$\operatorname{grad}(\operatorname{div} \vec{v})=\nabla (\nabla \cdot \vec{v})$$
$$\operatorname{div} (\operatorname{rot} \vec{v})=\nabla \cdot (\nabla \times\vec{v})$$
$$\operatorname{rot} (\operatorname{rot} \vec{v})=\nabla \times(\nabla \times\vec{v})$$
$$\Delta{\vec{v}}=\nabla^{2}\vec{v}$$

Практически весь математический аппарат гамильтоновой динамики вводится через один оператор "набла" и алгебру над кватернионами. 

В 1853 году Уильям Гамильтон ввёл оператор "набла" и придумал для него символ 
$\nabla$ в виде перевёрнутой греческой буквы и свое название "atled" (перевернутая "delta"). Современное название оператора происходит от финикийского символа "вобла".

В 1878 году Г. Фробениус доказал следующее утверждение (теорема Фробениуса): над полем действительных чисел $\mathbb{R}$ существуют лишь три конечномерные ассоциативные алгебры с делением: $\mathbb{R}$, поле комплексных чисел $\mathbb{C}$ и кватернионы
$\mathbb{H}$ [6].

В Лагранжевом формализме механическая система характеризуется лагранжианом: 
$\mathcal{L}(q, \dot{q}, t)$ — функцией обобщённых координат $q$ и соответствующих скоростей $\dot{q}$, а также, возможно, времени $t$. Траектория движения подчиняется принципу наименьшего действия. Принцип наименьшего действия - минимизация функционала действия для системы. 

Вариационная задача Лагранжа приводит к уравнению Эйлера-Лагранжа
$${\partial L \over \partial\vec{q}} - \frac{d}{dt} {\partial L \over \partial \dot{\vec{q}}} = 0$$
В Лагранжевой механике функционал действия можно представить, как сумму кинетической и  потенциальной энергии: $L = T(\dot{\vec{q}})-U(\vec{q})$. 
Кинетическую энергию частиц в системе запишем 
$$T = \sum_i\frac{m \dot{q}_i^2}{2}$$
Подставляем лагранжиан в таком виде и получаем
$$\frac{d}{dt}{\partial \over \partial \dot{\vec{q}}}\left[\sum_i\frac{m_i\dot{q}_i^2}{2} -U(\vec{q})\right] = 
{\partial \over \partial\vec{q}}\left[ \sum_i\frac{m_i\dot{q}_i^2}{2} -U(\vec{q})\right]
$$
В левой части уходит потенциальная энергия поскольку не зависит от скорости, в правой части уходит кинетическая энергия поскольку не зависит от координаты.
$$\frac{d}{dt}{\partial \over \partial \dot{\vec{q}}}\left[\sum_i\frac{m_i\dot{q}_i^2}{2}\right] = 
\frac{d}{dt}\left[\sum_i{m_i \dot{\vec{q}}_i}\right] =
-{\partial \over \partial\vec{q}}\left[ U(\vec{q})\right]
$$

С помощью преобразования Лежандра можно преобразовать лагранжиан в форму Гамильтона:
$$H\left(q,\;p,\;t\right)=\sum_{i}{\dot{q}}_{i}p_{i}-L(q,\;{\dot{q}},\;t)$$


Если расписать полный дифференциал этого выражения:

```math
dH=\sum _{i}\left[{\dot {q}}_{i}\,dp_{i}+p_{i}\,d{\dot {q}}_{i}-{\frac {\partial L}{\partial q_{i}}}dq_{i}-{\frac {\partial L}{\partial {\dot {q}}_{i}}}\,d{\dot {q}}_{i}\right]-\left({\frac {\partial L}{\partial t}}\right)dt=\\
=\sum _{i}\left[{\dot {q}}_{i}\,dp_{i}+p_{i}\,d{\dot {q}}_{i}-{\dot {p}}_{i}\,dq_{i}-p_{i}\,d{\dot {q}}_{i}\right]-{\frac {\partial L}{\partial t}}\,dt=\\
=\sum _{i}\left[{\dot {q}}_{i}\,dp_{i}-{\dot {p}}_{i}\,dq_{i}\right]-{\frac {\partial L}{\partial t}}\,dt.
```
И сравнить с дифференциалом 
```math
dH=\sum_{i}\left[{\frac{\partial H}{\partial q_{i}}}dq_{i}+{\frac{\partial H}{\partial p_{i}}}\,dp_{i}\right]+\left({\frac {\partial H}{\partial t}}\right)dt,
```
Получится два уравнения Гамильтона
$${\frac {\partial H}{\partial q_{j}}}=-{\dot {p}}_{j},\quad {\frac {\partial H}{\partial p_{j}}}={\dot {q}}_{j}$$
а также связь гамильтониана и лагранжиана:
$$\displaystyle \qquad {\frac {\partial H}{\partial t}}=-{\frac {\partial L}{\partial t}}$$

Система уравнений Гамильтона проще потому что содержит дифференциальные уравнения первого порядка. 

Любую функцию канонических переменных $f(q,p,t)$ можно представить в частных производных:
```math
{\frac {df}{dt}}={\frac {\partial f}{\partial t}}+\sum _{i}\left({\frac {\partial f}{\partial q_{i}}}{\dot {q_{i}}}+{\frac {\partial f}{\partial p_{i}}}{\dot {p_{i}}}\right)={\frac {\partial f}{\partial t}}\,+\,\sum _{i}\left({\frac {\partial f}{\partial q_{i}}}{\frac {\partial H}{\partial p_{i}}}-{\frac {\partial f}{\partial p_{i}}}{\frac {\partial H}{\partial q_{i}}}\right)
```
```math
\frac{df}{dt}  = \frac{\partial f}{\partial t} + \{H,f\},
```
где $\{H,f\}$ - скобка Пуассона.


Например, скорость находится согласно общим правилам дифференцирования
$$\frac {dx_{j}}{dt}=\frac {\partial x_{j}}{\partial t}+\{H,x_{j}\}$$
где $H$ — функция Гамильтона

Еще одним вариантом представления "канонических уравнений" является представление пары $(q,p)$ в форме (гипер-)комплексного числа. Это позволяет представить систему в виде одного уравнения. 

Пусть $\psi = q + i p$. Тогда уравнение примет вид ...

Положим интеграл "действие" равен нулю.

Примеры:

**Уравнения Максвелла в форме кватерниона**. Введем вектор - комплексная напряженность электромагнитного поля $\mathbf{F}=\mathbf{E}+i\mathbf{H}$ (композиция). $J = 4\pi(\rho, \mathbf{j})$ - 4-х мерный вектор (кватернион) состоящий из плотности заряда и вектора плотности тока. Получим уравнение, которое является произведением двух кватернионов.
$$(\frac{\partial}{\partial t}, \nabla) \mathbf{F} = \bar{J} $$

Можно показать, что это эквивалентная запись уравнений Максвелла в дифференциальной форме:

$$(\partial_{t},\nabla )\mathbf{F} = \left(\nabla \cdot \mathbf{F} ,\partial_{t}\mathbf{F} + i\nabla \times \mathbf{F} \right)=\left(\nabla \cdot \mathbf {E} +i\nabla \cdot \mathbf{H} ,\partial_{t}\mathbf{E} +i\partial_{t}\mathbf{H} +i\nabla \times \mathbf{E} -\nabla \times \mathbf{H} \right), \quad
{\overline{J}}=4\pi (\rho ,-\mathbf{j} )$$
```math
(\partial_{t},\nabla )\mathbf{F} ={\overline{J}}~\Leftrightarrow ~{
\begin{cases}
\nabla \cdot \mathbf{E} +i\nabla \cdot \mathbf{H} =4\pi \rho \\
\partial_{t}\mathbf{E} +i\partial _{t}\mathbf{H} +i\nabla \times \mathbf{E} -\nabla \times \mathbf{H} =-4\pi \mathbf{j} 
\end{cases}
}~\Leftrightarrow ~{
\begin{cases}
\nabla \cdot\mathbf{E} =4\pi \rho \\
\nabla \cdot\mathbf{H} =0\\
\partial_{t}\mathbf{E} -\nabla \times \mathbf{H} =-4\pi \mathbf{j} \\
\partial_{t}\mathbf{H} +\nabla \times \mathbf{E} =0
\end{cases}}
```
$\nabla$ — дифференциальный оператор "набла", при этом:
* $\nabla \times \mathbf{E} \equiv \mathrm{rot}~\mathbf{E}$ означает ротор вектора 
* $\nabla \cdot  \mathbf{E} \equiv \mathrm{div}~\mathbf{E}$ означает дивергенцию вектора 
$\mathbf{E}$.

Про Гамильтона можно сочинять сказки в духе Хармса. 

*У Гамильтона был ученик и продолжатель, Питер Тейт. После смерти Гамильтона Тейт продолжал применять идеи Гамильтона к разным дисциплинам. У Тейта был друг сокурсник, друга звали Джеймс Клерк Максвелл (JCM). Максвелл применил кватернионы к электромагнитным волнам и получил уравнения электродинамики.*

> В 1867 году Тэйт опубликовал «Элементарный трактат о кватернионах», использованный Максвеллом в своей работе над теорией электромагнитного поля.

*Джеймс Клерк Максвелл (JCM), подписывал свои письма $dp/dt$, потому что $JCM=dp/dt$.*

> В 1868 году Максвелл опубликовал очередную статью по электромагнетизму. Годом ранее появился повод существенно упростить изложение результатов работы. Он прочитал «Элементарный трактат о кватернионах» (An elementary treatise on quaternions) Питера Тэйта и решил применить кватернионную запись к многочисленным математическим соотношениям своей теории, что позволяло сократить и прояснить их запись. Одним из наиболее полезных инструментов стал гамильтонов оператор набла. Максвеллу принадлежала и первая запись уравнений электромагнитного поля в инвариантном векторном виде через гамильтонов оператор[83].

*Гамильтон прогуливался с женой по набережной и из хулиганских побуждений нацарапал ножичком на надпись i.j.k - дурак. Но его заметили и он от буквы F успел процарапать палочку -$\bar{1}$. Когда объяснял свой поступок, сказал, у меня в голове что-то замкнуло.. Так было введено обозначение для кватернионов. С тех пор мост в Дублине называется кватернионом Гамильтона и содержит табличку с нацарапанной надпиьсю - здесь был Гамильтон у него чего-то замкнуло в голове и он тут нацарапал i.j.k=-1.*

![Надпись на мосту Брум Бридж (Дублин)](images/Broom_Bridge.jpg "Тут у Сэра Гамильтона в голове что-то закоротило и он придумал кватернион, в честь чего на мосту нацарапал надпись... i.j.k=-1")

## Уравнения Гамильтона-Якоби

*Гамильтон много переписывался, но не общался с Гауссом. И редко покидал Ирландию. Однажды Гамильтон съездил на конференцию и встретил там Якоби. Якоби понравились теории Гамильтона и он стал продолжать и искать приложения в физике. Одно из таких приложений - переход от классического действия в формализме Лагранжа к каноническим уравнениям в обобщенных координатах.*

Поскольку $p={\partial S/\partial q},$ можно записать
$$-{\frac {\partial S}{\partial t}} = H\left(q,{\frac{\partial S}{\partial q}},t\right),$$
где S - действие - вводится как производящая функция (интеграл движения) в некоторых координатах, где Гамильтониан обращается в ноль (интеграл - константа).

## Уравнения квантовой механики

При выводе уравнения Гайзенберга (Шредингера) используются базовые принципы заложенные Гамильтоном и Якоби. И дополнительные свойства:
1. образовав композицию двух функций $\psi = f+i g$ можно заменить два уравнения на одно. Надо учесть некоторую идею того времени "волны материи" и волновые свойства частиц предложенные Луи де Бройлем и неопределенность детектирования с помощью волн. 
2. поскольку вычисления производятся в дискретном пространстве, возникает нормировка $\hbar$ - которая характеризует дискретность (неопределенность). Принцип неопределенности не является физически доказанным - это мысленный эксперимент с воображаемым прибором. Принцип существует как следствие принятия волновых свойств частиц. 
3. Функция S "действие" раскладывается на нормируемые ортогональные функции, которые образуют гильбертово пространство и являются решениями уравнения - Гамильтониана в некоторых обобщенных координатах обращается в ноль $H(\Psi)+i\hbar{\partial \over \partial{t}}\Psi = 0$. Суперпозиция функций $H(\Psi)$ может быть записана в операторной форме. В нормируемом пространстве ортогональных функций можно образовать вероятностное пространство. Физики договорились интерпретировать уравнения в терминах плотность вероятности. Существует способ вывода распределений и уравнений квантовой механики из выражений статистики и теории вероятности. 
4. Переход в дискретное пространство создает некоторую добавочную функцию к действию. В первом приближении добавка пропорциональна $\hbar$ и производной. В уравнении должен образоваться член "деквантизатор".
5. к черту кватернионы, попробуем без них.

<!-- Теорема. Оператор "деквантизация" в диксретной математике исправляет неопределенность интеграла действия.
$$\frac{1+z^{-1}}{1-z^{-1}}$$ 
Помимо времени существует неопределенность в пространстве, которая разрешается через диффузию ошибки - каскадное применение не коммутируемого оператора "набла". Остатки энергии могут перераспределяться между соседними квантами с целью выравнивания остатков. 
-->
## Коммутатор операторов

Коммутатором операторов $\hat{A}$ и $\hat{B}$ в общей алгебре, а также квантовой механике, называется оператор 
$$[\hat{A},\hat{B}] = \hat{A}\hat{B} - \hat{B}\hat{A}$$
В общем случае он не равен нулю. Понятие коммутатора распространяется на произвольные ассоциативные (некоммутативные) алгебры (не обязательно операторные).

* Антикоммутативность: $[A,B]=-[B,A]$. Из этого тождества следует что $[A,A]=0$ для любого оператора $A$.
* тождество Лейбница: $[F,GH]=[F,G]H+G[F,H]$.
* тождество Якоби: $[A,[B,C]]+[B,[C,A]]+[C,[A,B]]=0$. 

Ассоциативная Алгебра, с умножением удовлетворяющая тождеству Якоби, называется алгеброй Ли. Таким образом, из любой ассоциативной алгебры можно получить алгебру Ли, если определить умножение в новой алгебре, как коммутатор элементов старой алгебры. 

* Полная производная по времени от произвольной функции $f\colon M\times \mathbb {R} \to \mathbb {R}$ запишется в виде
```math
{\frac{d}{dt}}f = {\frac{\partial f}{\partial t}}+{\dot {q}}{\frac{\partial f}{\partial q}}+{\dot{p}}{\frac {\partial f}{\partial p}}=
{\frac{\partial }{\partial t}}f+\{H,f\}
```
* В канонических координатах $(q_{i},p_{j})$ скобки Пуассона принимают вид
```math
\{f,g\}=\sum_{i=1}^{N}\left({\frac{\partial f}{\partial p_{i}}}{\frac{\partial g}{\partial q^{i}}}-{\frac{\partial f}{\partial q^{i}}}{\frac{\partial g}{\partial p_{i}}}\right)
```
Из определения полной производной оператора по времени можно получить выражение для полной производной по времени от физической величины, а именно:
$${\dot {\hat {f}}}={i \over \hbar }[{\hat {H}},{\hat {f}}]+{\frac {\partial {\hat {f}}}{\partial t}}$$
Это соотношение является квантовым аналогом тождества в классической механике
$${\dot {f}}={\mathcal {\{}}H,f{\mathcal {\}}}+{\frac {\partial f}{\partial t}}$$

Разница в том что в квантовой механике оператор действует на комплексную функцию, а в классической механике применяются действительные переменные. 

Коммутатор в алгебре Ли (алгебра над операторами) соотносится со скобками Пуассона:

[5]: Ландау Лифшиц. Том.1

*Я не уверен что этот обзор следует углублять, хотел показать некоторую череду работ, которая приводит от уравнений гамильтоновой динамики к квантовой физике. Важным элементом является нормируемость пространства, что позволяет говорить про вероятности и плотности вероятности наблюдаемых величин.*

**Уравне́ния непреры́вности** — (сильная) локальная форма законов сохранения.

В нерелятивистской квантовой механике сохранение вероятности также приводит к уравнению непрерывности.

**Уравнение Лиувилля** описывает эволюцию во времени функции распределения (плотности вероятности) гамильтоновой системы. 

**Уравнение Гейзенберга** описывает эволюцию квантовой наблюдаемой гамильтоновой системы, полученное Вернером Гейзенбергом в 1925 году. Это уравнение имеет вид:
$${d \over dt}A={i \over \hbar }[H,A]+{\frac {\partial A}{\partial t}},$$
где $A$ — квантовая _наблюдаемая_, которая может явным образом зависеть от времени, $H$ — оператор Гамильтона, а скобки обозначают _коммутатор_. Если в качестве наблюдаемых взять операторы координат и импульсов, то получим квантовые аналоги классических уравнений Гамильтона.

Существует два представления эволюции квантовой системы изоморфных друг другу. Представление Гайзенберга и представление Шредингера. У Шредингера операторы не зависят от времени, но квантовые состояния зависят. У Гайзенберга квантовые состояния не меняются, операторы меняются. Довольно пугающий механизм предлагается для перехода от представления Шредингера через матричную экспоненту, которая описывает эволюцию во времени. Экспонента приводит к бесконечным рядам от операторов и коммутаторов.

Но эволюция системы это и есть бесконечное применение оператора к начальному состоянию.

*На самом деле не раскрывается как получено уравнение. Есть всего один вариант вывода - через статистику материальной точки. Т.е. базовый принцип вывода уравнений - через понятие стационарности действия и плотность вероятности нахождения частицы. Свои выводы Гайзенберг основывал на умозрительном эксперименте с гипотетическим рентгеновским микроскопом. Шрёдингер, судя по всему, свое уравнение написал просто так, без объяснений просто чтобы показать, что было бы в физике если бы теории де Бройле были реальностью. Основным фоном для физики тогда были работы Луи Де Бройля по волновым свойствам частиц и "волны материи" в уравнении Шредингера.*

Зачем все это? Я попробую обобщить. Нам нужно научиться описывать физические модели в дискретном пространстве. Модели относятся к классической механике и выражаются в терминах гамильтоновой динамики. Модели выражаются в операторной форме. В уравнениях используются комплексные функции из обобщенных координат и времени. Основной принцип уравнений - стационарность действия. Динамику можно выражать в кватернионах или в гиперкомплексных числах. Гиперкомплексные числа можно вводить через матрицы перестановок. Моя цель была бы достигнута, если бы удалось показать, что уравнения в гамильтоновом формализме являются следствием разложения функционала действия по обобщенным переменным. А сам интеграл - математический аппарат вариационного исчисления. 

## Приложение. Умножение кватернионов 

Чтобы приблизить к численным методам представим умножение в матричной форме. 

```math
pq = 
\begin{pmatrix*}[r]
p_0 &-p_1 &-p_2 &-p_3 \\
p_1 & p_0 &-p_3 & p_2 \\
p_2 & p_3 & p_0 &-p_1 \\
p_3 &-p_2 & p_1 & p_0 \\
\end{pmatrix*}
\begin{pmatrix*}[r]
q_0 \\
q_1 \\
q_2 \\
q_3 \\
\end{pmatrix*}
=
\begin{pmatrix*}[r]
p_0 q_0 &-p_1 q_1 &-p_2 q_2 &-p_3 q_3 \\
p_1 q_0 & p_0 q_1 &-p_3 q_2 & p_2 q_3 \\
p_2 q_0 & p_3 q_1 & p_0 q_2 &-p_1 q_3 \\
p_3 q_0 &-p_2 q_1 & p_1 q_2 & p_0 q_3 \\
\end{pmatrix*}
```
*В этом представлении я вижу простой способ умножения векторов за четыре операции и простой способ представления матриц поворотов. Поясню на примере.*

При такой записи:
* сопряжённому кватерниону соответствует транспонированная матрица:
$\bar{q}\mapsto Q^{T}$;
* четвёртая степень модуля кватерниона равна определителю соответствующей матрицы:
$\left|q\right|^{4}=\det Q$.

## Гиперкомплексные числа

Под этим заголовком представляем некоторый рекурсивный способ задания комплексных чисел. 

*Рекурсивный салат = салат из салата.*

Предположим, что мы вводим абстрактный математический класс комплексные "множества", который можно образовать от двух элементов любого множества обладающего признаками алгебры с некоммутативным умножением. Множество $\mathbb{C}$ мы образовали от двух элементов множества $\mathbb{R}$. Точно таким же образом можно образовать комплексные числа от множества комплексных чисел. Такие числа можем назвать словом гиперкомплексные. 

Гиперкомплексные числа можно определить как абстрактный математический класс. Допустимы у нас две независимые величины $p,q \in \mathbb{C}$. Введем некоторый символ для представления пары $p+jq = (a+ib)+j(c+id)$. Переход к алгебре кватернионов $ji=k$.
```cpp
typedef double  Real;
typedef complex<Real>  point;
typedef complex<point> quater;
```
Для рекуррентного определения нужно ввести операцию сопряжение и норма для базового типа `real`. Сопряжение гиперкомплексного числа определяется через сопряжение базового класса,  норма - через норму. 

*Первичным понятием должно быть скалярное произведение из которого можно определить норму и дистанцию. Возможно ли скалярное произведение определить рекурсивно, через скалярное произведение?*

*Необходимо ввести понятие определитель - детерминант*
Определитель комплексного числа это что такое?

```cpp 
// Умножение выполняется по правилам комплексных чисел.
quater operator * (quater a, quater b) {
    return {a.real * b.real  - a.image * conj(b.image),
            a.real * b.image + a.image * conj(b.real)};
}
// Сопряжённый элемент
quater conj(quater a) {
    return {conj(a.real), -a.image};
}
// Скалярное произведение.
ftype dot(quater a, quater b)
{
    return (a.image * conj(b.image) - a.real * b.real).real;
}
// Кватернионная норма
real   norm(quater a) {
    return -dot(a, conj(a));
}
// Длина
real   dist(quater a) {
    return sqrt(norm(a));
}
```




