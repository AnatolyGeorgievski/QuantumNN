# Цифровая обработка сигналов

* [API: Концепции и Базовые принципы](Concepts.md)
* [API: Протокол управления и сбора данных](API.md)
* [API: Математические структуры и классы](MATHAN.md)

## Базисные полиномы

_Базисные полиномы_. Нам нужно ввести понятие базисных полиномов, полиномы Бернштейна, Лагранжа, Эрмита, в частности. Нужно научиться получать разложения по выбранному базису полиномов. Целью разложения является поиск оптимального базиса, в котором удобно подбирать коэффициенты разложения. 

Интерполяция Лагранжа — это разложение по полиномам Лагранжа. Полиномы составляют базис, по которому раскладывается данная функция, т. е. данную функцию в этом базисе мы приближенно представляем, как линейную комбинацию — разложение по базисным функциям. 
```math
L_n(f;x) = \sum_{i=0}^n f(x_i) l_i(x); \quad 
l_i(x) = \prod_{\substack{j=0 \\  j \neq i}}^{N} {\frac{x-x_j}{x_i-x_j}}
```
где $f(x_i)$ - значения функции в точках $x_i$.

Разложение в ряд Тейлора - полиномы Тейлора.
```math
T_n(f;x) = \sum_{k=0}^n \frac{f^{(k)} (x_0) }{k!} (x - x_0)^k
```
при этом производные в дискретном пространстве будут представлены через конечные разности в точке $x_0$. На единичном интервале можно выбрать точку $x_{0}=0$ или $x_{0}=1$. 

Другой базис полиномов предложил российский математик Сергей Натанович Бернштейн[^3]. Базис ортогональных полиномов можно построить для любой степени на интервале $\left[0,1\right)$.
В общем виде базисные функции $\{ C_n^k x^k(1-x)^{(n-k)}\}_{k=0}^n$ для данной степени _n_ составляют полный набор, такой, что при любых $x \in [0,1]$ сумма базисных полиномов дает единицу — полиномы Бернштейна образуют _вероятностное пространство_. Полиномы выводятся из теории вероятностей, где аналогично вводится биномиальное распределение $C_n^k p^k q^{n-k}$ с вероятностью $p$ реализации события и вероятностью $q = (1-p)$ - дополнением.
```math
B(x) = \sum_{k=0}^{n} f(k/n) b_{k,n}(x); \quad\text{где} \quad b_{k,n}(x) = \binom{n}{k} x^k (1-x)^{n-k}
```
-- интерполяция базисными полиномами С.Н. Бернштейна.

Существуют и другие системы базисных полиномов, например, полиномы Пафнутия Львовича Чебышева. П.Л. Чебышев впервые ввел понятие ортогональных полиномов. 
- Полиномы Ньютона
- Полиномы Тейлора
- Полиномы Лагранжа
- Полиномы Бернштейна
- Полиномы Чебышева
- Полиномы Эрмита  

Все начинается с изучения степенного ряда $\sum_{k=0}^n a_k x^k$ и приводится к степенному ряду. Все разложения по полиномам изоморфны между собой, ряд составленный из аналитических функций можно привести к степенному ряду. Аналитическая (голоморфная) функция — функция, которая может быть представлена степенным рядом.  



Нас интересует разложение операторов по базисным полиномам и полиномы составленные из операторов. Для этого вводится понятие оператор задержки и оператор сдвига при выборке данных из потока данных.

## Конечные разности

В дискретной математике при вычислении интерполяционных полиномов, систем дифференциальных уравнений и цифровых фильтров вместо производных используются разности при данном шаге дискретизации ($h$).

Восходящей конечной разностью называется 
$$\Delta{y_k} = f(x_{k+1}) - f(x_k)$$

Нисходящей конечной разностью называется 
$$\nabla{y_k} = f(x_{k}) - f(x_{k-1})$$

Центральной разностью называется 
$$\delta{y_k} = f(x_{k}+h/2) - f(x_{k}-h/2)$$

При построении цифровых фильтров используются нисходящие разности, поскольку значения функции определены для прошлых отсчетов. Центральные разности используются при вычислении частных производных. 
Производную по времени можно представить через конечную разность: 

$$\frac{\Delta{y_k}}{\Delta{T}} = \frac{f(x_{k}) - f(x_{k-1})}{T_s}$$

Разности высоких порядков, как и производные определяются рекурсивно:
$$\Delta^{n}{y_k} = \Delta(\Delta^{n-1}{y_k}) = \Delta^{n-1}{y_{k+1}} - \Delta^{n-1}{y_{k}} , \quad\text{- восходящие разности}$$
$$\nabla^{n}{y_k} = \nabla(\nabla^{n-1}{y_k}) = \nabla^{n-1}{y_k} - \nabla^{n-1}{y_{k-1}} , \quad\text{- нисходящие разности}$$


Разницы нисходящие можно выражать через восходящие и наоборот 
$$\Delta{f(x_k)} = \nabla{f(x_k+h)} = \delta{f(x_k+h/2)}$$
$$\nabla{f(x_k)} = \Delta{f(x_k-h)} = \delta{f(x_k-h/2)}$$
$$\Delta^2{f(x_k)} = \nabla^2{f(x_k+2h)} = \delta^2{f(x_k+3/2h)}$$
$$\nabla^2{f(x_k)} = \Delta^2{f(x_k-2h)} = \delta^2{f(x_k-3/2h)}$$


## Бином Ньютона

Формула бинома - сумма ряда, применяется в теории вероятностей
```math
(p+q)^n = \sum_{k=0}^n C_{n}^{k} p^{n-k} q^k
```
Из нее следуют два свойства 
$$\sum_{k=0}^n C_{n}^{k} = 2^n , \quad \sum_{k=0}^n C_{n}^{k}(-1)^{k} = 0$$

Из нее следует некоторая техника получения "нормальных" разложений. Например полиномы Тейлора и полиномы Бернштейна получаются из биномиального разложения. В целом вся тема с аппроксимацией функций полиномами восходит к теореме Вейерштрасса.. Любую (аналитическую) функцию можно разложить на полиномы на интервале [0,1]. Бернштейн использовал для доказательства теоремы свои полиномы основанные на биномиальном разложении.

*Определение*. Аналитической функции вещественной переменной - которую можно представить в виде степенного ряда вблизи любой точки области определения. Или если потребовать бесконечного дифференцирования, то представить можно в виде разложения в ряд Тейлора. Аппроксимационная теорема Вейерштрасса утверждает, что можно на интервале представить аналитическую функцию полиномами. 

Используя тождество (формулу бинома) можно разложить  
```math
x^n = ((x-x_0)+x_0)^n = \sum_{k=0}^n C_{n}^{k} x_0^{n-k} (x-x_0)^k
```
и перейти к полиномам Тейлора вблизи выбранной точки $x_0$
```math
P_n(x) = \sum_{n=0}^N a_n x^n = \sum_{n=0}^N a_n\sum_{k=0}^n C_{n}^{k} x_0^{n-k} (x-x_0)^k
= \sum_{k=0}^N b_k (x-x_0)^k
```
Используя формулу бинома можно с тем же успехом перейти к полиномам Бернштейна
```math
1 = ((1-x)+x)^n = \sum_{k=0}^n C_{n}^{k} x^{n-k} (1-x)^k
```
Мое распределение выводится как
```math
2^n = ((1-x)+(1+x))^n = \sum_{k=0}^n C_{n}^{k} (1+x^{n-k} (1-x)^k
```


В теории вероятностей [^K1] [^C1] степенные ряды построенные от числовой последовательности называются производящей функцией, а ряды построенные с комплексной экспонентой - характеристической функцией. Таким образом без использования интегралов происходит (прямой) переход к численным методам над операторами в Z-пространстве и вводится Фурье преобразование. Z - пространство, то как оно вводится в теории линейных стационарных систем - конформное отображение от S-пространства, полученного через преобразование Лапласа от непрерывного представления функции. Само преобразование Лапласа вводится в теории вероятностей, как предельный переход от функции распределения биномиального распределения вероятностей. Обратное действие от предельного перехода в дискретное пространство не корректно. 

Предельный переход к непрерывной функции распределения основанной на биномиальном распределении приводит к нормальному распределению вероятностей. Говорят, Вейерштрасс изучая опыт физиков предложил свою аппроксимационную теорему как раз на основании интеграла Лапласа - нормального распределения, который использовался в теплофизике. 

Гильберт когда классифицировал проблемы современности, выделил ряд проблем связанных с решением дифференциальных уравнений с использованием аналитических функций. Постановка задачи сводится к представлению решения в форме разложений по ортогональным полиномам. 

Современная постановка задачи сильно завязана на активность исследований ИИ, с распознаванием функций (построением моделей) и представлением их в форме полиномов (B-сплайнов). В современной постановке необходимо обеспечить однозначный подбор параметров интерполяции.

## Интерполяция Ньютона

Интерполяционная формула может включать биномиальные коэффициенты. Вычисление бинома для вещественных чисел $q \in \mathbb{R}$:
```math
C_{q}^{k} = \binom{q}{k} = \frac{q(q-1)\dots(q-k+1)}{k!}, k \geq 0
```
Итерационная формула для вычисления бинома
```math
\binom{q}{0}=1;\quad \binom{q}{k} = \frac{q-k+1}{k} \binom{q}{k-1}, k \geq 0
```
Для записи бинома применяется "falling factorial" (перевернутый факториал)
$$(x)_k = x(x-1)(x-2)...(x-k+1); \quad (x)_0 = 1$$
И перевернутый вариант биномиального разложения тоже существует:
```math
(x+y)_n = \sum_{k=0}^n \binom{n}{k} (x)_{n-k} (y)_k
```
В дискретной математике разложение в ряд по конечным разностям - аналог разложения в ряд Тейлора
```math
f(x) = \sum_{k=0}^\infty \frac{\Delta^k f(a)}{k!} (x-a)_k 
     = \sum_{k=0}^\infty \binom{x-a}{k}\Delta^k f(a)
```

Обобщение полиномов построенных на обобщенных разницах и действительных биномиальных коэффициентах
```math
p_n(z) = \frac{z}{n} \binom{z-\beta n - 1}{n-1}
```
- $\beta = 0$ - получаются полиномы Ньютона
- $\beta = -1/2$ - полиномы Стирлинга
```math
f(z) = \sum_{n=0}^\infty p_n(z) \Delta^n f(\beta n) \text{ -- скользящие разности}
```

Многочлен Ньютона "интерполирование вперед": 
```math
P_n(x) = \sum_{k=0}^n\binom{q}{k} \Delta^n{y_0} 

= y_0 + q\Delta{y_0} + \frac{q(q-1)}{2}\Delta^2{y_0} + \dots + \frac{q(q-1)\dots(q-n+1)}{n!}\Delta^n{y_0},
```
где $q=(x-x_0)/h$, $y_i=f(x_i)$, а выражения $\Delta^k{y_0}$ - восходящие конечные разности.

Многочлен Ньютона "интерполирование назад": 
```math
P_n(x) = \sum_{k=0}^n (-1)^k\binom{-q}{k} \nabla^k{y_{n-k}}

= y_n + q\nabla{y_{n-1}} + \frac{q(q+1)}{2}\nabla^2{y_{n-2}} + \dots + \frac{q(q+1)\dots(q+n-1)}{n!}\nabla^n{y_0},
```
где $q=(x-x_n)/h$, а выражения $\nabla^k{y_{n-k}}$ - нисходящие конечные разности.

## Интерполяция Бесселя и Стирлинга

## Интерполяция полиномами Эрмита


## Полиномы Бернштейна

Полиномы Бернштейна имеют большое практическое значение в области компьютерного геометрического проектирования, а также во многих других областях математики из-за их многочисленных полезных свойств. Возможно, наиболее известное практическое применение полиномов Бернштейна заключается в определении кривых Безье и поверхностей Безье, которые представляют собой параметрические кривые и поверхности, использующие в своем представлении  базисные полиномы Бернштейна. 

Кривые и поверхности Безье могут быть использованы для аппроксимации любой кривой или поверхности с высокой степенью точности. 

Однако полиномы Бернштейна имеют множество других применений помимо компьютерной графики. Многочлены Бернштейна использовались в методах Галеркина и методах для решения эллиптических и гиперболических уравнений в частных производных.

Кроме того, они являются фундаментальными для теории аппроксимации, поскольку
позволяют доказать теорему Вейерштрасса об аппроксимации, которая гласит, что любая непрерывная функция на компактном интервале может быть равномерно аппроксимирована полиномами с любой степенью точности. Полиномы Бернштейна также находят применение в теории оптимального управления, стохастической динамике и в моделировании процессов, где они могут быть использованы в виде кривых Безье и в виде рекурсивного биномиального распределения в многомерном конфигурационном пространстве. Из полиномов Бернштейна можно сделать алгоритм для статистики ветвящихся процессов.

Несмотря на то, что многочлены Бернштейна обладают многими полезными свойствами, одним свойством, которым они не обладают, является ортогональность. Для многих приложений, таких как аппроксимация методом наименьших квадратов и методы конечных элементов, свойство ортогональности особенно полезно, и в результате применение многочленов Бернштейна в этих методах часто менее удобно, чем традиционные ортогональные многочлены, такие как многочлены Лежандра, многочлены Чебышева или многочлены Якоби. Чтобы преодолеть эту трудность, полиномиальный базис Бернштейна часто преобразуется в ортогональный полиномиальный базис с использованием матрицы преобразования. Однако, по мере увеличения степени полиномиального базиса, матрица преобразования между базисными наборами может стать некорректной, что может привести к существенной ошибке в численных расчетах.

В качестве альтернативы, ортонормированный базис полинома Бернштейна может быть сгенерирован с помощью процесса ортогонализации Грама-Шмидта, но этот процесс должен повторяться каждый раз, когда степень базиса полинома увеличивается. Очевидно, что во многих рассмотренных здесь приложениях было бы полезно иметь явное представление для генерации ортонормированных многочленов Бернштейна, но, насколько известно авторам, в литературе нет явного представления ортонормированных многочленов Бернштейна.

Цель этой статьи - представить явное представление ортонормированных многочленов Бернштейна, обсудить соответствующее им уравнение Штурма-Лиувилля и продемонстрировать их полезность для аппроксимации кривых и поверхностей.

Это хорошее введение. Но я почему-то хочу оставить все как есть. Ценность полиномов Бернштейна в том что они воспроизводят биномиальное распределение, а процесс ортогонализации дает другие полиномы, которые обладают свойством базиса но теряют явную связь с вероятностями. Замечательное свойство полиномов, они могут рассматриваться как вероятности - положительные функции, а для ортогональности необходимо чтобы функции были построены как разность. Но в контексте, надо рассматривать как это сделать.


Свойства 
1. симметрия $B_{k,n}(x) = B_{n-k,n}(1-x)$
2. положительность $B_{k,n}(x) \geq 0$
3. вероятности $\sum_{k=0}^n B_{k,n}(x) = 1$


Обобщение полиномов Бернштейна на произвольный интервал [a,b]
Подстановка $t = (x-a)/(b-a)$ приводит к форме
$$B_{k,n} = \binom{n}{k} \frac{(x-a)^k(b-x)^{n-k}}{(b-a)^n}$$



## Ортогонализация. Процесс Грама-Шмидта



## Интерполяция полиномами Бернштейна

Есть несколько идей по применению полиномов Бернштейн. 
1. Полиномы Бернштейна можно рассматривать как оператор (функционал) $B_n(f;x)$
2. можно доказать что Полиномы Бернштейна записываются через конечные разности
```math
B_n(f;x) = \sum\limits_{k=0}^n\binom{n}{k} \Delta^k{f(0)} x^k~,
```
где $\Delta f(x) = f(x+h)-f(x)$ конечные разности с шагом $h=1/n$.

Ранее мы рассматривали способ получения полиномов Бернштейна из формулы бинома. Формула бинома существует и для перевернутых факториалов и не только..

Формула Готфрида Лейбница (Gottfried Leibniz (1646–1716)) для производной
```math
\frac{d^n}{dx^n}[f(x)g(x)] = \sum\limits_{k=0}^n \binom{n}{k} \frac{d^k}{dx^k}f(x) \frac{d^{n-k}}{dx^{n-k}}g(x)
```

Формула для восходящих конечных разностей
```math
\Delta^n[f(x_i)g(x_i)] = \sum\limits_{k=0}^n \binom{n}{k} \Delta^k[f(x_i)] \Delta^{n-k}[g(x_{i+k})]
```
Заметим, что нисходящие разности (backward differences) можно выразить через восходящие (forward differences) или через центральные разности. 
$$\nabla^k f(x_i) = \Delta^k f(x_{i-k})$$
для $i\geq k \geq 0$.

## Ортогональные полиномы Лежандра

Ортогональность функций определяется через свойство скалярного произведения. 
Скалярное произведение действительных непрерывных функций можно определить:
$$(f_n,f_m) = \int_a^b f_n(x) f_m(x) dx$$
В евклидовом (линейном векторном) пространстве вводится понятие норма. В теории функции - сходимость по норме. 
Две функции называются ортогональные на интервале [a,b] если 
$$(f_n,f_m) = \int_a^b f_n(x) f_m(x) dx = 0~, ~~\text{для}\quad n \neq m$$

*Полиномы Лежандра* задаются рекуррентной формулой 
$$p_{n+1}(x) = (x-\alpha_n)p_n(x) - \beta_n p_{n-1}(x)$$
где $\alpha_n = (x p_n(x), p_n(x))$, $\beta_n = (p_n(x), p_{n-1}(x))$

## Ортогональные полиномы

Скалярное произведение непрерывных функций в обобщенном виде, по Лебегу:
$$(f_n,f_m) = \int_a^b f_n(x) \overline{f_m(x)} d\mu(x)$$
В теории функции[^1] вводится интеграл Лебега-Стилтьеса, (по плотности)? когда множество можно отобразить на линейную ось. 
$$(f_n,f_m) = \int_a^b f_n(x) \overline{f_m(x)} w(x) dx$$
Если плотность нормирована, то интеграл можно интерпретировать по плотности вероятности. Функция w(x) - весовая функция. Операция сопряжения используется на множестве комплексных функций. 



## Интерполяция сплайнами 

Сплайны задаются через узловые точки.

### Базовый сплайн (B-сплайн)

Базовый сплайн задается на интервале $\left[0,1\right)$  и обобщает интерполяцию полиномами Бернштейна. Сплайны мы рассматриваем в виде последовательности разложения с повышением степени полиномов.
B-сплайны могут быть вычислены с помощью рекурсивного алгоритма Кокса — де Бура, (обобщающего алгоритм де Кастельжо [^1] [^2]): 
- B-сплайн как и в случае интерполяции Лагранжа проходит через узловые точки.
- сплайн нулевого порядка =1 на интервале и =0 вне интервала.
- рекурсивное построение
- результат для степени (p) и числа точек k. 

#### Алгоритм де Бура

Позволяет разложить B-сплайн в каскад сплайнов первого порядка. Новый набор контрольных точек вычисляется через первоначальный рекурсивно для каждого уровня разложения. 


## Проектирование Цифровых Фильтров 

Проектирование в S-пространстве 
```math
HP(s) = \frac{1}{s^2+\frac{\omega_0}{Q_0} s+\omega_0^2}
```
При замене переменных 
$$s = \frac{2}{T_s} \frac{1-z^{-1}}{1+z^{-1}}$$
Возникает разложение операторов по полиномам 
$$\frac{1}{2^{n-k} T_s^k}(1-z^{-1})^k(1+z^{-1})^{n-k}$$
<!-- _Как это выводится_. Я беру за основу полиномы Бернштейна, которые получены для вероятностей. Вероятности p и q должны рассчитываться в один момент времени. Если $q = (1-z^{-1})$ - мы считаем разницу $x_k$ и $x_{k-1}$. Это - конечная разница в точке $(x_k + x_{k-1})/2$ 

Поэтому базисные полиномы из биномиального распределения следует переписать таким образом:
```math
g_{k,n} = C_n^k (1-x)^k \left(\frac{1+x}{2}\right)^{n-k}
```
-->
Цифровые фильтры вводятся через соотношения величин $F_c$ - частота среза, $F_s$ - частота дискретизации, $Q$ - добротность фильтра на частоте среза. $K = \tan(\pi F_c/F_s)$ 
$$a_1 = K^2 ,\quad a_3 = K/Q$$


Фильтры highpass, lowpass, bandpass можно переписать в операторной форме:
```math
HP(z) = \frac{(1-z^{-1})^2}{(1-z^{-1})^2 + a_1(1+z^{-1})^2 + a_3 (1- z^{-2})}
```
```math
LP(z) = \frac{a_1(1+z^{-1})^2}{(1-z^{-1})^2 + a_1(1+z^{-1})^2 + a_3 (1- z^{-2})}
```
```math
BP(z) = \frac{a_3(1-z^{-2})}{(1-z^{-1})^2 + a_1(1+z^{-1})^2 + a_3 (1- z^{-2})}
```
Видно, что разложение может быть выполнено по базису полиномов $(1-z^{-1})^2$, $(1+z^{-1})^2$, $(1-z^{-2})$
в нем фильтры HP, LP, BP оказываются ортогональными, т.е любой фильтр можно представить, как их линейную комбинацию. Причем $HP(z)+LP(z)+BP(z)=1$

Фильтры Баттерворта высоких порядков в S-пространстве вводятся 
```math
H(s) = \frac{1}{\prod_{k=1}^{n/2} \left(s^2 + 2 \sin(\theta_k) \beta s + \beta^2 \right) }, 
\text{где}\quad \theta_k = \frac{2 k -1 }{2n}\pi, \text{для четных n} 
```
```math
H(s) = \frac{1}{(s+\beta)\prod_{k=1}^{(n-1)/2} \left(s^2 + 2 \sin(\theta_k) \beta s + \beta^2 \right) }, 
\text{для нечетных n} 
```
На практике обычно используют фильтры четных порядков. Фильтры в Z-пространстве будут представлены каскадом секций второго порядка (SOS). 

Полиномы можем выбрать в одном из трех базисов, соответствующих начальным, конечным и центральным разностям или в степенном базисе.
Естественным является базис
```math
\left\{ (1-z^{-1})^k(1+z^{-1})^{n-k} \right\}_{k=0}^n
```


## Адаптивные фильтры

Коэффициенты фильтров FIR (finite impulse response) можно подстраивать по методу наименьших квадратов при наличии критерия качества. 

Для подстройки фильтров мы предлагаем использовать числа на интервале $[0,1]$ - вероятностное пространство, фильтры определены на множестве значений, с разложением по базисным полиномам данной степени, причем $$\sum_{k=0}^n b_k = 1$$ 

Существует несколько эквивалентных вариантов разложения по полиномам. 
- степенной базис $\{z^{-k}\}$
- полиномы Тейлора $\{(z^{-1}-1)^k\}$
- полиномы Бернштейна $\{z^{-k}(1- z^{-1})^{n-k}\}$
- полиномы Мои $\{(1+z^{-1})^{k}(1- z^{-1})^{n-k}\}$

Полиномы в степенном базисе
```math
P_0(z) = 1; \quad
P_k(z) = \bar{\beta_{k}} + {\beta_{k}} z^{-1} P_{k-1}(z)
```
Полиномы Тейлора
```math
T_0(z) = 1; \quad
T_k(z) = \bar{\beta_{k}} + {\beta_{k}} (z^{-1}-1) T_{k-1}(z)
```
Полиномы Бернштейна строятся рекурсивно
```math
B_0(z) = 1; \quad
B_k(z) = \bar{\beta_{k}} z^{-k} + {\beta_{k}} (1-z^{-1}) B_{k-1}(z)
```


Полиномы Мои строятся рекурсивно
```math
S_0(z) = 1; \quad
S_k(z) = \bar{\beta_{k}} \left(1+z^{-1}\right)^k + {\beta_{k}} (1-z^{-1}) S_{k-1}(z)
```
По сути, мои полиномы получаются из разложения в степенной ряд в S-пространстве с подстановкой для перехода в Z-пространство. 
$$s= \frac{1-z^{-1}}{1+z^{-1}},$$
Для подобных переходов существует понятие Конформные отображения в расширенной комплексной плоскости. Все подобные конформные отображения образуют пространство конформных отображений. Операторы составленные таким образом образуют собой пространство линейных операторов со своей алгеброй над операторами. 

### Производящая функция числового ряда
Производящей функцией числовой последовательности $\{a_k\}$ называется ряд
```math
\sum_{n=0}^m a_n s^n  = \sum_{n=0}^m a_n \sum_{k=0}^n C_{n}^{k} p^{n-k} q^k , \text{где} \quad s=p+q
```
Используя формулу бинома, степенной ряд можно представить как полиномы в форме Бернштейна, где $s = ((1-x)+x)$. Или можно взять $s=((1-x)+(1+x))$


Прежде всего необходимо определить симметрию фильтра и выбрать одно из трех:
- симметричные, f(x)=f(-x)
- антисимметричные, f(x)=-f(-x)

Коэффициенты разложения по степеням будут попарно равны $b_k = b_{n-k}$ или $b_k = -b_{n-k}$ 

В этих случаях фильтр 
```math
H(z) = g \sum_{k=0}^{\lfloor n/2 \rfloor} b_k z^{-k}(1\pm z^{-(n-2k)}); \quad \sum_{k=0}^n b_k = 1
```
применяется к сумме или к центральной разнице $\delta^k_{n/2}$.

Фильтр можно рассматривать, как разложение по конечным (центральным) разностям в точке n/2.

## PID-регуляторы

Передаточная функция регулятора состоит их трех компонент $P+I+D$, пропорциональной интегральной и дифференциальной, с общим коэффициентом усиления:
```math
C(s) = P(s)+I(s)+D(s) = K_p\left(1+\frac{1}{T_i \cdot s} + T_d D(s)\right)
```
$T_i$ – время интегрирования, $T_d$ – время дифференцирования. 

Для перехода в Z- пространство используется подстановка
$$s= \frac{2}{T_s} \frac{1-z^{-1}}{1+z^{-1}},$$
где $T_s$ – период дискретизации.
```math
C(z) = g ( \bar{\beta_1} P(z)+\beta_1 I(z)(\bar{\beta_2}+\beta_2 D(z)) )
```
передаточные функции компонент представлены в операторной форме:
```math
P(z) = (1-z^{-1});\quad I(z) = (1+z^{-1})/2;\quad D(z) = (1-z^{-1})^2 LPF(z).
```
Фильтр $D(z)$ применяется к усредненному значению параметра, $LPF(z)$ - фильтр нижних частот (сокр. Low-Pass Filter). 


```math
C(z) = g \left( \bar{\beta_1}+ \beta_1 \left( \bar{\beta_2} L_1(z) + \beta_2 (1-z^{-1}) L_{\alpha}(z) \right) \right)
```
где $L_1(z)$ и $L_{\alpha}(z)$ - фильтры нижних частот с передаточной функцией: 
```math 
L_1(z) = \frac{1}{2} \frac{1+z^{-1}}{1-z^{-1}} ;\quad
  L_\alpha(z) = \frac{1}{2} \frac{\bar{\alpha}(1+z^{-1})}{1-\alpha z^{-1}}
```
Коэффициент $\alpha$ выбирается исходя из отношения
```math
\alpha = \frac{T_s - 2 T_d/\gamma}{T_s + 2 T_d/\gamma} ,
```
где $T_s$ - период дискретизации, $T_d$ - время дифференцирования $\gamma$ - эмпирический параметр, выбирается порядка 10 для обеспечения устойчивости алгоритма.


## Конформные отображения

## Линейные операторы

* [LaTeX.math] <https://en.wikibooks.org/wiki/LaTeX/Mathematics>
* [DSP.dsplib] <https://ru.dsplib.org/>